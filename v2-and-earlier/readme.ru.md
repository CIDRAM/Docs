## Документация для CIDRAM v2 (Русский)

### Содержание
- 1. [ПРЕДИСЛОВИЕ](#user-content-SECTION1)
- 2. [ИНСТАЛЛЯЦИЯ](#user-content-SECTION2)
- 3. [ИСПОЛЬЗОВАНИЕ](#user-content-SECTION3)
- 4. [УПРАВЛЕНИЕ ФРОНТЕНД](#user-content-SECTION4)
- 5. [СОДЕРЖАНИЕ ПАКЕТА ФАЙЛОВ](#user-content-SECTION5)
- 6. [НАСТРОЙКИ](#user-content-SECTION6)
- 7. [СИГНАТУР ФОРМАТ](#user-content-SECTION7)
- 8. [ИЗВЕСТНЫЕ ПРОБЛЕМЫ СОВМЕСТИМОСТИ](#user-content-SECTION8)
- 9. [ЧАСТО ЗАДАВАЕМЫЕ ВОПРОСЫ (FAQ)](#user-content-SECTION9)
- 10. *Зарезервировано для будущих дополнений к документации.*
- 11. [ЛЕГАЛЬНАЯ ИНФОРМАЦИЯ](#user-content-SECTION11)

*Regarding translations: My native language is English. Because this is a free and open-source hobby project which generates zero income, and translatable content is likely to change as the features and functionality supported by the project changes, it doesn't make sense for me to spend money for translations. Because I'm the sole author/developer/maintainer for the project and I'm not a ployglot, any translations I produce are very likely to contain errors. Sorry, but realistically, that won't ever change. If you find any such errors/typos/mistakes/etc, your assistance to correct them would be very much appreciated. Pull requests are invited and encouraged. Otherwise, if you find these errors too much to handle, just stick with the original English source. If a translation is irredeemably incomprehensible, let me know which, and I can delete it. If you're not sure how to perform pull requests, ask. I can help.*

---


### 1. <a name="SECTION1"></a>ПРЕДИСЛОВИЕ

CIDRAM/СИДРАМ (Бесклассовая Адресация Доступа Менеджер / Classless Inter-Domain Routing Access Manager) это скрипт предназначен для защиты веб-сайтов, путем блокирования запросов, исходящих из IP-адресов рассматривается как источников нежелательного трафика, в том числе (но не ограничивается) трафик с конечными точками доступа нечеловеческих, клоуд/облачные сервисы, спамботы, скребки, и т.д. Она делает это путем вычисления возможной CIDR из IP-адресов, поставляется из входящих запросов, а затем попытка сопоставить эти возможные CIDR с его сигнатур файлы (эти сигнатур файлы содержат списки CIDR из IP-адресов рассматривается как источников нежелательного трафика); Если совпадения найдены, запросы блокируются.

*(Видеть: [Что такое «CIDR»?](#user-content-WHAT_IS_A_CIDR)).*

[CIDRAM](https://cidram.github.io/) авторское право 2016 года, а также GNU/GPLv2, созданный [Caleb M (Maikuolan)](https://github.com/Maikuolan).

Это руководство находится в свободном доступе. Вы можете его передавать и/или модифицировать на условиях GNU General Public License, как публикует Фонд свободного программного обеспечения (Free Software Foundation); либо под второй версией лицензии, либо любой другой более поздней версией (по вашему выбору). Пособие публикуется не в целях увеличения прибыли или создания себе рекламы, а лишь в надежде принести пользу, правда, без всякой гарантии. Подробности Вы можете узнать на странице GNU General Public License в разделе `LICENSE.txt`, а также на страницах:
- <https://www.gnu.org/licenses/>.
- <https://opensource.org/licenses/>.

Этот документ с относящимися к нему пакетом файлов можно бесплатно скачать на страницах:
- [GitHub](https://github.com/CIDRAM/CIDRAM).
- [Bitbucket](https://bitbucket.org/Maikuolan/cidram).

---


### 2. <a name="SECTION2"></a>ИНСТАЛЛЯЦИЯ

#### 2.0 ИНСТАЛЛЯЦИЯ ВРУЧНУЮ

1) Скачайте архив на свой компьютер и откройте его. На хост-компьютере или в системе управления содержимым (CMS) создайте регистр, куда Вы хотите загрузить содержимое этого пакета. Такой регистр, как `/public_html/cidram/`, будет вполне достаточным, пока он отвечает вашим требованиям к защите или личным предпочтениям.

2) Переименовать `config.ini.RenameMe` в `config.ini` (расположенный внутри `vault`), и если Вы хотите (рекомендуются для опытных пользователей, имеющих соответствующие знания), открой это (этот файл содержит все параметры конфигурации для CIDRAM; краткие комментарии описывают задачи каждой параметры). Измените величины в соответствии с Вашими потребностями. Сохраните файл и закройте.

3) Скачайте всё содержимое (CIDRAM и файлы) в указанный в пункте 1 регистр, кроме файлов `*.txt`/`*.md`.

4) Право доступа `vault`-регистра поменяйте на «755» (если есть проблемы, Вы можете попробовать „777“; это менее безопасно, хотя). Права доступа вышестоящего папка, в котором находится содержание (папка в который Вы наметили занести файлы) могут остаться прежними, но всё же лучше проверить доступ, если случились проблемы с доступом (обычно должно быть „755“ в стандарта). Вкратце: Чтобы пакет работал правильно, PHP должен иметь возможность читать и писать файлы в каталоге `vault`. Многие вещи (обновление, ведение журнала, и т.д.) не будут возможны, если PHP не может писать в каталог `vault`, и пакет не будет работать вообще, если PHP не может читать из каталога `vault`. Однако для обеспечения оптимальной безопасности каталог `vault` НЕ должен быть общедоступным (конфиденциальная информация, такая как информация, содержащаяся в файле `config.ini` или `frontend.dat`, может быть обнаружена потенциальными злоумышленниками, если каталог `vault` является общедоступным).

5) Скрепите CIDRAM с Вашей системой или с системой управления содержимым (CMS). Для этого есть много способов. Самым простым является способ, когда CIDRAM-руководство является началом главного файла, который будет загружаться всякий раз, когда будут заходить на ваш интернет-сайт. Этот файл нужно связать с Вашей системой или с системой управления содержимым (CMS) при помощи `require` или `include` команд. Обычно такой файл обозначается в регистре как `/includes`, `/assets` или `/functions`, и часто называется `init.php`, `common_functions.php`, `functions.php`. Вы должны найти тот файл, который соответствует Вашим требованиям. Если это трудно для Вас, то посетите страница вопросов CIDRAM на GitHub. Возможно я или кто-то другой уже имеет опыт работы с CMS, которую используете вы, и сможет дать Вам совет (обязательно сообщите, какой CMS Вы пользуетесь). Введите прямо в начало этого файла следующий код:

`<?php require '/user_name/public_html/cidram/loader.php'; ?>`

Строку между кавычками замените локальным путём файла в формате `loader.php`, без HTTP-адреса (подобно пути для `vault`-регистра). Сохраните файл и закройте его; Загрузите его заново.

-- АЛЬТЕРНАТИВА --

Если у Вас Apache HTTP-сервер и доступ к нему в формате `php.ini` или похожем формате, Вы можете воспользоваться `auto_prepend_file`-директивой, установя приоритет CIDRAM, когда последует PHP-запрос. Примерно так:

`auto_prepend_file = "/user_name/public_html/cidram/loader.php"`

Или в `.htaccess` файлом:

`php_value auto_prepend_file "/user_name/public_html/cidram/loader.php"`

6) На этом инсталляционный процесс заканчивается. :-)

#### 2.1 ИНСТАЛЛЯЦИЯ С ПОМОЩЬЮ COMPOSER

[CIDRAM зарегистрирован в Packagist](https://packagist.org/packages/cidram/cidram), и так, если Вы знакомы с Composer, Вы можете использовать Composer для инсталляция CIDRAM (Вам все равно нужно будет подготовить конфигурацию, разрешения и крючки; См. „инсталляция вручную“, шаги 2, 4, и 5).

`composer require cidram/cidram`

#### 2.2 ИНСТАЛЛЯЦИЯ ДЛЯ WORDPRESS

Если Вы хотите использовать CIDRAM с WordPress, Вы можете проигнорировать все вышеприведенные инструкции. [CIDRAM зарегистрирован как плагин с базой данных плагинов WordPress](https://wordpress.org/plugins/cidram/), и Вы можете установить CIDRAM непосредственно из панели плагинов. Вы можете установить его так же, как любой другой плагин, и никаких дополнительных шагов не требуется. Подобно другим методам установки, Вы можете настроить свою инсталляция, изменив содержимое файла `config.ini`, или с помощью конфигурация страница в фронтенд. Если Вы активировать CIDRAM фронтенд и обновить CIDRAM используя обновления страница в фронтенд, это автоматически синхронизируется с информацией о версии плагина, отображаемой в панели инструментов плагинов.

*Предупреждение: Обновление CIDRAM через панель инструментов плагинов приводит к чистой установке! Если Вы персонализированные свою инсталляция (изменили вашу конфигурацию, установленные модули и т.д.), эти персонализации будут потеряны при обновлении через панель инструментов плагинов! Лог-файлы также будут потеряны! Чтобы сохранить файлы журналов и настройки, обновите страницу с CIDRAM фронтенд.*

---


### 3. <a name="SECTION3"></a>ИСПОЛЬЗОВАНИЕ

CIDRAM должен автоматически блокировать нежелательные запросы на свой веб-сайт, без необходимости ручного помощь, кроме его первоначальной инсталляция.

Вы можете настроить конфигурацию, и настроить какие CIDRы заблокированы, путем изменения файла конфигурации и/или ваши сигнатур файлы.

Если Вы обнаружили ложноположительный, пожалуйста, свяжитесь со мной чтобы сообщить мне об этом. *(Видеть: [Что такое „ложноположительный“?](#user-content-WHAT_IS_A_FALSE_POSITIVE)).*

CIDRAM можно обновлять вручную или через фронтенд. CIDRAM также может быть обновлен через Composer или WordPress, если они первоначально установлены с помощью этих средств.

---


### 4. <a name="SECTION4"></a>УПРАВЛЕНИЕ ФРОНТЕНД

#### 4.0 ЧТО ЯВЛЯЕТСЯ ФРОНТЕНД.

Фронтенд обеспечивает удобный и простой способ для поддержания, управления и обновить инсталляция CIDRAM. Вы можете просматривать, обмениваться и скачать лог-файлы через страницу для лог-файлы, Вы можете изменить конфигурацию с помощью страницы конфигурации, Вы можете устанавливать и удалять компоненты через страницу обновления, и Вы можете загрузить, скачать, и изменять файлы в вашем vault с помощью файл менеджер.

Фронтенд по умолчанию отключена в целях предотвращения несанкционированного доступа (несанкционированного доступа может иметь серьезные последствия для вашего веб-сайта и его безопасности). Инструкции по включению его включены ниже этого пункта.

#### 4.1 КАК ВКЛЮЧИТЬ ФРОНТЕНД.

1) Найдите директиву `disable_frontend` внутри `config.ini`, и установить его на `false` (это будет `true` по умолчанию).

2) Перейти на `loader.php` из вашего браузера (например, `http://localhost/cidram/loader.php`).

3) Войти с именем пользователя и паролем по умолчанию (admin/password).

Заметка: После того, как Вы вошли в первый раз, в целях предотвращения несанкционированного доступа к фронтенд, Вы должны немедленно изменить имя пользователя и пароль! Это очень важно, потому что это можно загрузить произвольный PHP код на свой веб-сайт через фронтенд.

Кроме того, для обеспечения оптимальной безопасности настоятельно рекомендуется включить «двухфакторную аутентификацию» для всех аккаунтов фронтенд (инструкции приведены ниже).

#### 4.2 КАК ИСПОЛЬЗОВАТЬ ФРОНТЕНД.

Инструкции предоставляются на каждой странице в фронтенд, чтобы объяснить правильный способ использовать его и его целевое назначение. Если Вам нужна дополнительная объяснение или любой специальный помощь, обратитесь в поддержки. Дополнительно, есть некоторые видео доступны на YouTube, которые могли бы помочь путем демонстрации.

#### 4.3 ДВУХФАКТОРНАЯ АУТЕНТИФИКАЦИЯ

Возможно сделать фронтенд более безопасным, включив двухфакторную аутентификацию («2FA»). При входе в аккаунт с поддержкой 2FA, электронное письмо отправляется на адрес электронной почты, связанный с этой аккаунтой. Это электронное письмо содержит «код 2FA», который затем должен ввести пользователь в дополнение к имени пользователя и паролю, чтобы иметь возможность войти в систему, используя эту аккаунт. Это означает, что получить пароль аккаунтой будет недостаточно для того, чтобы любой хакер или потенциальный злоумышленник могли войти в эту аккаунт, потому что им также необходимо будет иметь доступ к адресу электронной почты, связанному с этой аккаунтой, чтобы иметь возможность получать и использовать код 2FA, связанный с сеансом, что делает фронтенд более безопасным.

Во-первых, чтобы включить двухфакторную аутентификацию, используя страницу обновлений фронтенда, установите компонент PHPMailer. CIDRAM использует PHPMailer для отправки электронных писем. Следует отметить, что хотя CIDRAM, сам по себе, совместим с PHP >= 5.4.0, PHPMailer требует PHP >= 5.5.0, поэтому означает, что включение двухфакторной аутентификации для фронтенда CIDRAM будет невозможно для пользователей PHP 5.4.

После того, как Вы установили PHPMailer, вам нужно будет заполнить директивы конфигурации для PHPMailer через страницу конфигурации CIDRAM или файл конфигурации. Более подробная информация об этих директивах конфигурации содержится в разделе конфигурации этого документа. После того, как Вы заполнили директивы конфигурации PHPMailer, установите `enable_two_factor` в `true`. На этом этапе должна быть включена двухфакторная аутентификация.

Затем вам нужно связать адрес электронной почты с аккаунтой, чтобы CIDRAM знал, куда отправлять коды 2FA при входе в эту аккаунт. Для этого используйте адрес электронной почты в качестве имени пользователя для аккаунтой (например, `foo@bar.tld`), или указать адрес электронной почты как часть имени пользователя так же, как при отправке письма обычно (например, `Foo Bar <foo@bar.tld>`).

Заметка: Особенно важна защита вашего vault от несанкционированного доступа (например, посредством укрепления безопасности вашего сервера и ужесточение разрешений общего доступа), поскольку несанкционированный доступ к вашему конфигурационному файлу (который хранится в вашем vault), может подвергнуть риску выставлять исходящие настройки SMTP (это включает имя пользователя и пароль SMTP). Вы должны убедиться, что ваше vault правильно защищено, прежде чем включить двухфакторную аутентификацию. Если Вы не можете этого сделать, то, по крайней мере, Вы должны создать новую аккаунт электронной почты, предназначенную для этой цели, чтобы уменьшить риски, связанные с открытыми параметрами SMTP.

---


### 5. <a name="SECTION5"></a>СОДЕРЖАНИЕ ПАКЕТА ФАЙЛОВ

```
https://github.com/CIDRAM/CIDRAM>v2
│   .gitattributes
│   .gitignore
│   Changelog.txt
│   composer.json
│   LICENSE.txt
│   loader.php
│   README.md
│   tests.php
├───.docker
│       docker-compose.yml
├───.github
│   │   FUNDING.yml
│   │
│   └───workflows
│           php-cs-fixer.yml
│           v2.yml
└───vault
    │   bypasses.php
    │   bypasses.yml
    │   captcha_default.html
    │   channels.yaml
    │   cidramblocklists.dat
    │   components.dat
    │   config.ini.RenameMe
    │   config.php
    │   config.yaml
    │   event_handlers.php
    │   frontend.php
    │   frontend_functions.php
    │   functions.php
    │   ignore.dat
    │   ipv4.dat
    │   ipv4_bogons.dat
    │   ipv4_custom.dat.RenameMe
    │   ipv4_isps.dat
    │   ipv4_nonblocking.dat
    │   ipv4_other.dat
    │   ipv6.dat
    │   ipv6_bogons.dat
    │   ipv6_custom.dat.RenameMe
    │   ipv6_isps.dat
    │   ipv6_nonblocking.dat
    │   ipv6_other.dat
    │   lang.php
    │   modules.dat
    │   outgen.php
    │   template_custom.html
    │   template_default.html
    │   themes.dat
    │   verification.yaml
    ├───classes
    │   │   Aggregator.php
    │   │   Captcha.php
    │   │   Constants.php
    │   │   HCaptcha.php
    │   │   ReCaptcha.php
    │   │   Reporter.php
    │   │
    │   └───Maikuolan
    │           Cache.php
    │           ComplexStringHandler.php
    │           DelayedIO.php
    │           Demojibakefier.php
    │           Events.php
    │           IPHeader.php
    │           L10N.php
    │           Matrix.php
    │           NumberFormatter.php
    │           Operation.php
    │           Request.php
    │           YAML.php
    ├───fe_assets
    │       auxiliary.js
    │       frontend.css
    │       frontend.html
    │       icons.php
    │       lock_bl_c.png
    │       lock_bl_o.png
    │       lock_rd_c.png
    │       lock_rd_o.png
    │       lock_wt_c.png
    │       lock_wt_o.png
    │       pips.php
    │       scripts.js
    │       _2fa.html
    │       _accounts.html
    │       _accounts_row.html
    │       _aux.html
    │       _aux_edit.html
    │       _cache.html
    │       _cidr_calc.html
    │       _cidr_calc_row.html
    │       _config.html
    │       _config_row.html
    │       _files.html
    │       _files_edit.html
    │       _files_rename.html
    │       _files_row.html
    │       _fixer.html
    │       _home.html
    │       _ip_aggregator.html
    │       _ip_test.html
    │       _ip_test_row.html
    │       _ip_tracking.html
    │       _ip_tracking_row.html
    │       _login.html
    │       _logs.html
    │       _nav_complete_access.html
    │       _nav_logs_access_only.html
    │       _range.html
    │       _range_intersector.html
    │       _range_row.html
    │       _range_subtractor.html
    │       _sections.html
    │       _statistics.html
    │       _updates.html
    │       _updates_row.html
    └───lang
            lang.ar.fe.yaml
            lang.ar.yaml
            lang.bn.fe.yaml
            lang.bn.yaml
            lang.de.fe.yaml
            lang.de.yaml
            lang.en.fe.yaml
            lang.en.yaml
            lang.es.fe.yaml
            lang.es.yaml
            lang.fr.fe.yaml
            lang.fr.yaml
            lang.hi.fe.yaml
            lang.hi.yaml
            lang.id.fe.yaml
            lang.id.yaml
            lang.it.fe.yaml
            lang.it.yaml
            lang.ja.fe.yaml
            lang.ja.yaml
            lang.ko.fe.yaml
            lang.ko.yaml
            lang.lv.fe.yaml
            lang.lv.yaml
            lang.nl.fe.yaml
            lang.nl.yaml
            lang.no.fe.yaml
            lang.no.yaml
            lang.pl.fe.yaml
            lang.pl.yaml
            lang.pt.fe.yaml
            lang.pt.yaml
            lang.ru.fe.yaml
            lang.ru.yaml
            lang.sv.fe.yaml
            lang.sv.yaml
            lang.ta.fe.yaml
            lang.ta.yaml
            lang.th.fe.yaml
            lang.th.yaml
            lang.tr.fe.yaml
            lang.tr.yaml
            lang.ur.fe.yaml
            lang.ur.yaml
            lang.vi.fe.yaml
            lang.vi.yaml
            lang.zh-tw.fe.yaml
            lang.zh-tw.yaml
            lang.zh.fe.yaml
            lang.zh.yaml
```

---


### 6. <a name="SECTION6"></a>НАСТРОЙКИ

Ниже представлен список переменных данных в файле конфигурации `config.ini`, а также краткое описание их функций.

```
Configuration (v2)
├───general
│       logfile
│       logfile_apache (v1: logfileApache)
│       logfile_serialized (v1: logfileSerialized)
│       error_log
│       error_log_stages
│       truncate
│       log_rotation_limit
│       log_rotation_action
│       timezone
│       time_offset (v1: timeOffset)
│       time_format (v1: timeFormat)
│       ipaddr
│       forbid_on_block
│       silent_mode
│       lang
│       lang_override
│       numbers
│       emailaddr
│       emailaddr_display_style
│       † (v1: disable_cli)
│       disable_frontend
│       max_login_attempts
│       frontend_log (v1: FrontEndLog)
│       signatures_update_event_log
│       ban_override
│       log_banned_ips
│       default_dns
│       search_engine_verification
│       social_media_verification
│       other_verification
│       protect_frontend
│       disable_webfonts
│       maintenance_mode
│       default_algo
│       statistics
│       force_hostname_lookup
│       allow_gethostbyaddr_lookup
│       hide_version
│       empty_fields
│       log_sanitisation
│       disabled_channels
│       default_timeout
│       config_imports
│       events
├───signatures
│       ipv4
│       ipv6
│       block_attacks
│       block_cloud
│       block_bogons
│       block_generic
│       block_legal
│       block_malware
│       block_proxies
│       block_spam
│       modules
│       default_tracktime
│       infraction_limit
│       track_mode
│       tracking_override
├───recaptcha
│       usemode
│       lockip
│       lockuser
│       sitekey
│       secret
│       expiry
│       logfile
│       signature_limit
│       api
│       show_cookie_warning
│       show_api_message
│       nonblocked_status_code
├───hcaptcha
│       usemode
│       lockip
│       lockuser
│       sitekey
│       secret
│       expiry
│       logfile
│       signature_limit
│       api
│       show_cookie_warning
│       show_api_message
│       nonblocked_status_code
├───legal
│       pseudonymise_ip_addresses
│       omit_ip
│       omit_hostname
│       omit_ua
│       privacy_policy
├───template_data
│       theme
│       magnification (v1: Magnification)
│       css_url
├───PHPMailer
│       event_log (v1: EventLog)
│       skip_auth_process (v1: SkipAuthProcess)
│       enable_two_factor (v1: Enable2FA)
│       host (v1: Host)
│       port (v1: Port)
│       smtp_secure (v1: SMTPSecure)
│       smtp_auth (v1: SMTPAuth)
│       username (v1: Username)
│       password (v1: Password)
│       set_from_address (v1: setFromAddress)
│       set_from_name (v1: setFromName)
│       add_reply_to_address (v1: addReplyToAddress)
│       add_reply_to_name (v1: addReplyToName)
├───rate_limiting
│       max_bandwidth
│       max_requests
│       precision_ipv4
│       precision_ipv6
│       allowance_period
│       exceptions
└───supplementary_cache_options
        prefix
        enable_apcu
        enable_memcached
        enable_redis
        enable_pdo
        memcached_host
        memcached_port
        redis_host
        redis_port
        redis_timeout
        pdo_dsn
        pdo_username
        pdo_password
```

#### «general» (Категория)
Генеральная конфигурация от CIDRAM.

##### «logfile»
- Файл разборчивыми для людей, для регистрации всех заблокированных попыток несанкционированного доступа. Задайте имя файлу, или оставьте пустым чтобы деактивировать опцию.

##### «logfile_apache»
- *v1: «logfileApache»*
- Apache-стиль файл для регистрации всех заблокированных попыток несанкционированного доступа. Задайте имя файлу, или оставьте пустым чтобы деактивировать опцию.

##### «logfile_serialized»
- *v1: «logfileSerialized»*
- Сериализованная файл для регистрации всех заблокированных попыток несанкционированного доступа. Задайте имя файлу, или оставьте пустым чтобы деактивировать опцию.

*Полезный совет: Если Вы хотите, Вы можете добавить информацию о дате/времени к именам файлов журналов путем включения их во имя: `{yyyy}` для полный год, `{yy}` для сокращенный год, `{mm}` для месяц, `{dd}` для день, `{hh}` для час.*

*Примеры:*
- *`logfile='logfile.{yyyy}-{mm}-{dd}-{hh}.txt'`*
- *`logfile_apache='access.{yyyy}-{mm}-{dd}-{hh}.txt'`*
- *`logfile_serialized='serial.{yyyy}-{mm}-{dd}-{hh}.txt'`*

##### «error_log»
- Файл для регистрации обнаруженных нефатальных ошибок. Задайте имя файлу, или оставьте пустым чтобы деактивировать опцию.

##### «error_log_stages»
- Список этапов в цепочке выполнения, в которых должны регистрироваться любые сгенерированные ошибки.
- *Стандарт: "Tests,Modules,SearchEngineVerification,SocialMediaVerification,OtherVerification,Aux,Reporting,Tracking,RL,CAPTCHA,Statistics,Webhooks,Output,NonBlockedCAPTCHA"*

##### «truncate»
- Усекать лог-файлы, когда они достигают определенного размера? Значение это максимальный размер в Б/КБ/МБ/ГБ/ТБ, до которого файл журнала может увеличиться до усечения. Стандартное значение 0КБ отключает усечение (лог-файлы может расти неограниченно). Примечание: относится к отдельным лог-файлы! Размер файлов журнала не учитывается совместно.

##### «log_rotation_limit»
- Лог вращения ограничивает количество журнальных лог-файлов, которые должны существовать в любой момент времени. Когда создаются новые лог-файлы, если общее количество лог-файлов превышает указанный предел, указанное действие будет выполнено. Здесь Вы можете указать желаемый лимит. Значение 0 отключит вращение лог.

##### «log_rotation_action»
- Лог вращения ограничивает количество журнальных лог-файлов, которые должны существовать в любой момент времени. Когда создаются новые лог-файлы, если общее количество лог-файлов превышает указанный предел, указанное действие будет выполнено. Здесь Вы можете указать желаемое действие. Delete = Удалите самые старые лог-файлы, пока лимит больше не будет превышен. Archive = Сначала архивируйте, а затем удалите самые старые лог-файлы, пока лимит больше не будет превышен.

*Техническое разъяснение: В этом контексте, «самые старые» означает наименее недавно измененный.*

##### «timezone»
- Это используется, чтобы указать, какой часового пояса CIDRAM должен использовать для операций даты/времени. Если вам это не нужно, игнорируйте его. Возможные значения определяются PHP. Обычно рекомендуется вместо того, чтобы настроить директиву о зоне времени в файле `php.ini`, но иногда (например, при работе с общими хостинг-провайдеров, которые ограничены) это не всегда возможно, и так, эта опция представлена здесь.

##### «time_offset»
- *v1: «timeOffset»*
- Если ваш сервер времени не соответствует вашему местному времени, Вы можете указать смещение здесь для корректировки информации о дате/времени генерируется от CIDRAM в соответствии с вашими потребностями. Обычно рекомендуется вместо того, чтобы настроить директиву о зоне времени в файле `php.ini`, но иногда (например, при работе с общими хостинг-провайдеров, которые ограничены) это не всегда возможно, и так, эта опция представлена здесь. Смещение описывается как минут.
- Пример (добавить один час): `time_offset=60`

##### «time_format»
- *v1: «timeFormat»*
- Формат нотации даты, используемый CIDRAM. Стандарт = `{Day}, {dd} {Mon} {yyyy} {hh}:{ii}:{ss} {tz}`.

##### «ipaddr»
- Место IP-адреса актуального соединения в общем потоке данных (полезно для Cloud-сервиса). Стандарт = REMOTE_ADDR. ВНИМАНИЕ: Изменяйте это значение только в том случае, если Вы уверены в своих действиях!

Рекомендуемые значения для «ipaddr»:

Значения | Контекст
---|---
`HTTP_INCAP_CLIENT_IP` | Incapsula обратный прокси-сервер.
`HTTP_CF_CONNECTING_IP` | Cloudflare обратный прокси-сервер.
`CF-Connecting-IP` | Cloudflare обратный прокси-сервер (альтернатива; если вышеуказанное не работает).
`HTTP_X_FORWARDED_FOR` | Cloudbric обратный прокси-сервер.
`X-Forwarded-For` | [Squid обратный прокси-сервер](http://www.squid-cache.org/Doc/config/forwarded_for/).
`Forwarded` | *[Forwarded - HTTP \| MDN](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Forwarded).*
*Определяется конфигурацией сервера.* | [Nginx обратный прокси-сервер](https://www.nginx.com/resources/admin-guide/reverse-proxy/).
`REMOTE_ADDR` | Не обратный прокси-сервер (стандартное значение).

##### «forbid_on_block»
- Какое сообщение статуса HTTP должно отправлять CIDRAM при блокировке запросов?

Поддерживаемые значения:

Код состояния | Сообщение состояния | Описание
---|---|---
`200` | `200 OK` | Стандартное значение. Наименее надежный, но наиболее удобный для пользователя. Автоматизированные запросы, скорее всего, интерпретируют этот ответ как указание на то, что запрос был выполнен успешно.
`403` | `403 Forbidden` | Более надежен, но менее удобен в использовании. Рекомендуется для большинства общих обстоятельств.
`410` | `410 Gone` | Может вызвать проблемы при разрешении ложных срабатываний, поскольку некоторые браузеры кэшируют это сообщение о состоянии и не отправляют последующие запросы даже после разблокировки. Может быть наиболее предпочтительным в некоторых контекстах, для определенных видов трафика.
`418` | `418 I'm a teapot` | Отсылает к первоапрельской шутке ([RFC 2324](https://tools.ietf.org/html/rfc2324#section-6.5.14)). Очень маловероятно, что это будет понято каким-либо клиентом, ботом, браузером, или кем-либо еще. Предоставляется для развлечения и удобства, но обычно не рекомендуется.
`451` | `451 Unavailable For Legal Reasons` | Рекомендуется при блокировке преимущественно по юридическим причинам. Не рекомендуется в других контекстах.
`503` | `503 Service Unavailable` | Самый надежный, но наименее удобный для пользователя. Рекомендуется при атаке или при работе с чрезвычайно постоянным нежелательным трафиком.

##### «silent_mode»
- Должен CIDRAM молча перенаправить заблокированные попытки доступа вместо отображения страницы «Доступ Закрыт»? Если да, указать местоположение для перенаправления блокировал попытки доступа. Если нет, оставить эту переменную пустым.

##### «lang»
- Задаёт CIDRAM стандарт языка.

##### «lang_override»
- Локализовать в соответствии с HTTP_ACCEPT_LANGUAGE, когда это возможно? True = Да [Стандарт]; False = Нет.

##### «numbers»
- Указывает, как отображать числа.

Поддерживаемые значения:

Значение | Производит | Описание
---|---|---
`NoSep-1` | `1234567.89`
`NoSep-2` | `1234567,89`
`Latin-1` | `1,234,567.89` | Значение по умолчанию.
`Latin-2` | `1 234 567.89`
`Latin-3` | `1.234.567,89`
`Latin-4` | `1 234 567,89`
`Latin-5` | `1,234,567·89`
`China-1` | `123,4567.89`
`India-1` | `12,34,567.89`
`India-2` | `१२,३४,५६७.८९`
`India-3` | `૧૨,૩૪,૫૬૭.૮૯`
`India-4` | `੧੨,੩੪,੫੬੭.੮੯`
`India-5` | `೧೨,೩೪,೫೬೭.೮೯`
`India-6` | `౧౨,౩౪,౫౬౭.౮౯`
`Arabic-1` | `١٢٣٤٥٦٧٫٨٩`
`Arabic-2` | `١٬٢٣٤٬٥٦٧٫٨٩`
`Arabic-3` | `۱٬۲۳۴٬۵۶۷٫۸۹`
`Arabic-4` | `۱۲٬۳۴٬۵۶۷٫۸۹`
`Bengali-1` | `১২,৩৪,৫৬৭.৮৯`
`Burmese-1` | `၁၂၃၄၅၆၇.၈၉`
`Khmer-1` | `១.២៣៤.៥៦៧,៨៩`
`Lao-1` | `໑໒໓໔໕໖໗.໘໙`
`Thai-1` | `๑,๒๓๔,๕๖๗.๘๙`
`Thai-2` | `๑๒๓๔๕๖๗.๘๙`

*Заметка: Эти значения нигде не стандартизируются и, вероятно, не будут иметь значения за пределами пакета. Кроме того, поддерживаемые значения могут измениться в будущем.*

##### «emailaddr»
- Если Вы хотите, Вы можете предоставить адрес электронной почты здесь чтобы дать пользователям, когда они заблокированы, для их использования в качестве точки контакта за поддержку и/или помощь ибо в случае их блокирования по ошибке. ПРЕДУПРЕЖДЕНИЕ: Любой адрес электронной почты Вы предоставляете здесь наверняка будет найдены по спамботами и скребки во время используется здесь, и так, это настоятельно рекомендуется, если Вы решите добавить адрес электронной почты здесь, что Вы убедитесь что адрес электронной почты что Вы предоставляете здесь одноразовый адрес и/или адрес который Вы не против чтобы быть спамом (другими словами, Вы вероятно не хотите использовать ваши основные личные электронной почты или первичные бизнес электронной почты).

##### «emailaddr_display_style»
- Как Вы предпочитаете, чтобы адрес электронной почты был представлен пользователям? «default» = Ссылки кликабельны. «noclick» = Текст не кликабельны.

##### «disable_cli»
- *(Удалены начиная с v2).*
- Деактивировать ли CLI-модус? Обычно CLI-модус активирован. Однако иногда он может отрицательно влиять на определённые тестовые программы (например на PHPUnit) и другие приложения, базирующиеся на CLI. Если CLI-модус нельзя деактивировать, то эту команду нужно игнорировать. False = CLI-модус активирован [Стандарт]; True = CLI-модус деактивирован.

##### «disable_frontend»
- Деактивировать доступ к фронтенд? Доступ к фронтенд может сделать CIDRAM более управляемым, но также может быть потенциальный риск безопасности. Рекомендуется чтобы управлять CIDRAM через бэкенд когда возможно, но доступ к фронтенд предоставлен для того когда это не возможно. Держите его деактивирована за исключением того если Вам это нужно. False = Активировать доступ к фронтенд; True = Деактивировать доступ к фронтенд [Стандарт].

##### «max_login_attempts»
- Максимальное количество попыток входа в систему фронтенда. Стандарт = 5.

##### «frontend_log»
- *v1: «FrontEndLog»*
- Файл для запись всех попыток входа в фронтенд. Задайте имя файлу, или оставьте пустым чтобы деактивировать опцию.

##### «signatures_update_event_log»
- Файл для регистрации при обновлении сигнатурей через фронтенд. Задайте имя файлу, или оставьте пустым чтобы деактивировать опцию.

##### «ban_override»
- Переопределить «forbid_on_block» когда «infraction_limit» превысило? Когда переопределении: Блокированные запросы возвращают пустую страницу (файлы шаблонов не используются). 200 = Не переопределить [Стандарт]. Другие значения совпадают с доступными значениями для «forbid_on_block».

##### «log_banned_ips»
- Включить заблокированные запросы от запрещенных IP-адресов в лог-файлы? True = Да [Стандарт]; False = Нет.

##### «default_dns»
- Разделенный запятыми список DNS-серверов, чтобы использовать для имен хостов поиска. Стандарт = «8.8.8.8,8.8.4.4» (Google DNS). ВНИМАНИЕ: Изменяйте это значение только в том случае, если Вы уверены в своих действиях!

*Смотрите также: [Что я могу использовать для «default_dns»?](#что-я-могу-использовать-для-default_dns)*

##### «search_engine_verification»
- Попытка проверить запросы от поисковых систем? Верификация поисковых систем гарантирует, что они не будут запрещены в результате превышения предела нарушение (запрет на поисковые системы с вашего сайта, как правило, оказывают негативное влияние на вашей поисковой системы рейтинга, SEO, и т.д.). Когда проверяется, поисковые системы могут быть заблокированы, но не запрещено. Когда не проверяется, это возможно для них должны быть запрещены в результате превышения лимита нарушений. Дополнительно, верификация поисковых систем обеспечивает защиту от подделки запросов поисковой системы и вредоносные источники маскируются как поисковые системы (такие запросы будут заблокированы при проверке поисковой активируется). True = Активировать верификация поисковых систем [Стандарт]; False = Деактивировать верификация поисковых систем.

В настоящее время поддерживается:
- __[Applebot](https://discussions.apple.com/thread/7090135)__
- __[Baiduspider/百度](https://help.baidu.com/question?prod_en=master&class=Baiduspider)__
- __[Bingbot](https://blogs.bing.com/webmaster/2012/08/31/how-to-verify-that-bingbot-is-bingbot)__
- __[DuckDuckBot](https://duckduckgo.com/duckduckbot)__
- __[Googlebot](https://support.google.com/webmasters/answer/80553?hl=en)__
- __[MojeekBot](https://www.mojeek.com/bot.html)__
- __[PetalBot](https://aspiegel.com/petalbot)__
- __[Qwantify/Bleriot](https://help.qwant.com/bot)__
- __[SeznamBot](https://napoveda.seznam.cz/en/full-text-search/seznambot-crawler/)__
- __[Sogou/搜狗](https://www.sogou.com/docs/help/webmasters.htm#07)__
- __[Yahoo/Slurp](https://help.yahoo.com/help/us/ysearch/slurp)__
- __[Yandex/Яндекс](https://yandex.com/support/webmaster/robot-workings/check-yandex-robots.xml)__
- __[Youdao/有道](https://udger.com/resources/ua-list/bot-detail?bot=YoudaoBot#id1507)__

Не совместимо (вызывает конфликты):
- __[Mix.com](https://github.com/CIDRAM/CIDRAM/issues/80)__

##### «social_media_verification»
- Попытка проверить запросы в социальных сетях? Проверка социальных сетей обеспечивает защиту от поддельных запросов в социальных сетях (такие запросы будут заблокированы). True = Активировать проверку социальных сетей [Стандарт]; False = Деактивировать проверку социальных сетей.

В настоящее время поддерживается:
- __[Embedly](https://udger.com/resources/ua-list/bot-detail?bot=Embedly#id22674)__
- __** [Facebook external hit](https://developers.facebook.com/docs/sharing/webmasters/crawler/)__
- __[Pinterest](https://help.pinterest.com/en/articles/about-pinterest-crawler-0)__
- __[Twitterbot](https://udger.com/resources/ua-list/bot-detail?bot=Twitterbot#id6168)__

_**: Требуется функция поиска ASN, например, из модуля BGPView._

##### «other_verification»
- По возможности, пытаться проверить другие типы запросов (например, AdSense, средства проверки SEO, и т.д.)? При обнаружении, поддельные запросы будут заблокированы. True = Активировать [Стандарт]; False = Деактивировать.

В настоящее время поддерживается:
- __[AdSense](https://developers.google.com/search/docs/advanced/crawling/overview-google-crawlers)__
- __[AmazonAdBot](https://adbot.amazon.com/index.html)__
- __[Oracle Data Cloud Crawler](https://www.oracle.com/corporate/acquisitions/grapeshot/crawler.html)__

##### «protect_frontend»
- Определяет, будут ли средства защиты как правило предоставляемые CIDRAM должны быть применены к фронтенд. True = Да [Стандарт]; False = Нет.

##### «disable_webfonts»
- Отключить веб-шрифты? True = Да [Стандарт]; False = Нет.

##### «maintenance_mode»
- Включить режим обслуживания? True = Да; False = Нет [Стандарт]. Отключает все, кроме фронтенд. Иногда полезно при обновлении CMS, фреймворков и т.д.

##### «default_algo»
- Определяет, какой алгоритм использовать для всех будущих паролей и сеансов. Опции: PASSWORD_DEFAULT (стандарт), PASSWORD_BCRYPT, PASSWORD_ARGON2I (требует PHP >= 7.2.0), PASSWORD_ARGON2ID (требует PHP >= 7.3.0).

##### «statistics»
- Отслеживать статистику использования CIDRAM? True = Да; False = Нет [Стандарт].

##### «force_hostname_lookup»
- Поиск имен хостов для всех запросов? True = Да; False = Нет [Стандарт]. Поиск имен хостов обычно выполняется по принципу «по мере необходимости», но может быть принудительно для всех запросов. Это может быть полезно в качестве средства предоставления более подробной информации в логфайлах, но может также иметь слегка отрицательный эффект на производительность.

##### «allow_gethostbyaddr_lookup»
- Разрешить поиск gethostbyaddr, когда UDP недоступен? True = Да [Стандарт]; False = Нет.
- *Примечание. Поиск IPv6 может работать некорректно на некоторых 32-разрядных системах.*

##### «hide_version»
- Скрыть информацию о версии из журналов и вывода на страницу? True = Да; False = Нет [Стандарт].

##### «empty_fields»
- Как CIDRAM обрабатывать пустые поля при регистрации и отображении информации о событии блока? «include» = Включить пустые поля. «omit» = Опустить пустые поля [стандарт].

##### «log_sanitisation»
- При использовании фронтенд страницы журналов для просмотра данных журнала, CIDRAM подготавливает данные журнала перед их отображением таким образом, чтобы защитить пользователей от атак XSS. Однако эти меры обычно не происходят, когда данные впервые регистрируются. Это необходимо для обеспечения точного сохранения данных журнала, чтобы помочь любому эвристическому анализу, который может потребоваться в будущем. Однако в случае, если пользователь пытается прочитать данные журнала, используя внешние инструменты, которые не подготавливают данные журнала аналогичным образом для защиты пользователей, пользователь может подвергаться атакам XSS. При необходимости Вы можете изменить поведение по умолчанию с помощью этой директивы конфигурации. True = Подготавливайте данные при первой регистрации (данные сохраняются менее точно, но риск XSS ниже). False = Не подготавливайте данные при первой регистрации (данные сохраняются более точно, но риск XSS выше) [Стандарт].

##### «disabled_channels»
- Это можно использовать для предотвращения использования CIDRAM определенных каналов при отправке запросов (например, при обновлении, при извлечении метаданных компонента, и т.д.).
- *Доступные варианты: `GitHub,BitBucket,GoogleDNS`*

##### «default_timeout»
- Тайм-аут по умолчанию для внешних запросов? Стандарт = 12 секунд.

##### «config_imports»
- Список файлов, разделенных запятыми, для импорта в стандартную конфигурацию CIDRAM. Обычно заполняется по мере необходимости на странице обновлений при активации компонентов. В большинстве случаев можно игнорировать это.

##### «events»
- Перечисленные здесь файлы загружаются сразу после файла обработчиков событий. Обычно заполняется по мере необходимости на странице обновлений при активации компонентов. В большинстве случаев можно игнорировать это.

#### «signatures» (Категория)
Конфигурация сигнатур.

##### «ipv4»
- Список сигнатур IPv4 файлы, которые CIDRAM должен попытаться обработать, разделенных запятыми. Вы можете добавлять записи здесь, если Вы хотите, чтобы включить дополнительные IPv4 сигнатур файлы в CIDRAM.

##### «ipv6»
- Список сигнатур IPv6 файлы, которые CIDRAM должен попытаться обработать, разделенных запятыми. Вы можете добавлять записи здесь, если Вы хотите, чтобы включить дополнительные IPv6 сигнатур файлы в CIDRAM.

##### «block_attacks»
- Блокировать CIDRы, связанные с атаками и другим аномальным трафиком? Например, сканирование портов, взлом, поиск уязвимостей, т.д. Если Вы не испытываете проблем при этом, как правило, эта директива должна быть true.

##### «block_cloud»
- Блокировать CIDRы идентифицирован как принадлежащий услуг веб-хостинга / облачные сервисы? Если Вы управляете службы API с вашего сайта, или если Вы ожидать что другие веб-сайты чтобы подключиться к ваш веб-сайт, эта директива должна быть false. Если Вы этого не сделаете, эта директива должна быть true.

##### «block_bogons»
- Блокировать марсианин/bogon CIDRы? Если Вы ожидаете посетителей на свой веб-сайт из вашей локальной сети или из локальной сети, эта директива должна быть false. В противном случае, эта директива должна быть true.

##### «block_generic»
- Блокировать CIDRы рекомендуется для черных списков? Это охватывает любые сигнатур, которые не помечены как часть какой-либо из других более конкретных категорий сигнатур.

##### «block_legal»
- Блокировать CIDRы в ответ на юридические обязательства? Эта директива обычно не должна иметь никакого эффекта, поскольку CIDRAM не связывает CIDR с «юридическими обязательствами» по умолчанию, но тем не менее он существует как дополнительная контрольная мера в интересах любых пользовательских файлов сигнатуры или модулей, которые могут существовать по юридическим причинам.

##### «block_malware»
- Блокировать CIDRы, связанные с вредоносным программы? Это включает в себя серверы C&C; зараженные машины; машины, участвующие в распространении вредоносных программ; и т.д.

##### «block_proxies»
- Блокировать CIDRы идентифицированы как принадлежащие к прокси-серверов или VPNs? Если Вам требуется, чтобы пользователи смогли получить доступ к вашему веб-сайт от прокси-серверов и VPNs, эта директива должна быть false. В противном случае, если Вам не нужны прокси-серверов или VPNs, эта директива должна быть true как средство повышения безопасности.

##### «block_spam»
- Блокировать CIDRы которые были определены как высокого риска для спама? Если Вы не испытываете проблем при этом, как правило, эта директива должна быть true.

##### «modules»
- Список модуль файлы для загрузки после обработки сигнатуры IPv4/IPv6, разделенных запятыми.

##### «default_tracktime»
- Сколько секунд чтобы отслеживать IP-адреса, запрещенные модулями. Стандарт = 604800 (1 неделя).

##### «infraction_limit»
- Максимальное число нарушений IP-разрешено брать на себя, прежде чем она запрещена отслеживание IP. Стандарт = 10.

##### «track_mode»
- Когда следует учитывать нарушения? False = Когда IP-адреса блокируются из модулями. True = Когда IP-адреса блокируются по какой-либо причине. Стандарт = False.

##### «tracking_override»
- Разрешить модулям переопределять параметры отслеживания? True = Да [Стандарт]; False = Нет.

#### «recaptcha» и «hcaptcha» (эти две категории предоставляют одинаковые директивы).
При желании, вы можете представить пользователям задачу CAPTCHA, чтобы отличить их от ботов или позволить им восстановить доступ в случае блокировки. Это может помочь уменьшить количество ложноположительный и уменьшить нежелательный автоматизированный трафик.

*Примечание: CAPTCHA защищает только от машинных вызовов, а не от людей.*

Вы можете получить «site key» и «secret key» для reCAPTCHA отсюда:
- https://developers.google.com/recaptcha/

Вы можете получить «site key» и «secret key» для hCAPTCHA отсюда:
- https://www.hcaptcha.com/

##### «usemode»
- Когда следует предлагать CAPTCHA? Примечание: Запросы из белого списка или проверенные и неблокированные запросы никогда не требуют выполнения CAPTCHA.

Значение | Описание
--:|:--
1 | Только когда блокировке, в пределах лимита сигнатурей, и не забанен.
2 | Только когда заблокирован, специально помечен для использования, в пределах лимита сигнатурей, и не забанен.
3 | Только когда в пределах лимита сигнатурей, и не забанен (вне зависимости от того, заблокирован ли).
4 | Только когда не заблокирован.
5 | Только когда не заблокирован, или специально помечен для использования, в пределах лимита сигнатурей, и не забанен.
Любое другое значение. | Никогда!

##### «lockip»
- Определяет ли хэши должны быть привязаны к конкретным IP-адресов. False = Куки и хэши МОЖЕТ использоваться в нескольких IP-адресов (стандарт). True = Куки и хэши НЕ может использоваться в нескольких IP-адресов (куки/хэши привязаны к IP-адресов).
- Заметка: Значение «lockip» игнорируется когда «lockuser» дезактивированный/false, благодаря тому что механизм для запоминания «users» различается в зависимости от этого значения.

##### «lockuser»
- Определяет ли успешное завершение инстанция reCAPTCHA/hCAPTCHA должны быть привязаны к конкретным пользователям. False = Успешное завершение инстанция reCAPTCHA/hCAPTCHA будет предоставлять доступ ко всем запросам происходящих из того же IP который используемый пользователем что завершение инстанция reCAPTCHA/hCAPTCHA; Куки и хэши не используются; Вместо, IP белый список будет использоваться. True = Успешное завершение инстанция reCAPTCHA/hCAPTCHA будет только предоставлять доступ к пользователю что завершение инстанция reCAPTCHA/hCAPTCHA; Куки и хэши используются чтобы помнить пользователю; IP белый список не используется.

##### «sitekey»
- Это значение можно найти на панели управления вашей службы CAPTCHA.

##### «secret»
- Это значение можно найти на панели управления вашей службы CAPTCHA.

##### «expiry»
- Количество часов, чтобы вспомнить инстанция CAPTCHA. Стандарт = 720 (1 месяц).

##### «logfile»
- Записывать все попытки CAPTCHA? Если да, указать имя использовать для файла журнала. Если нет, оставьте эту переменную пустым.

*Полезный совет: Если Вы хотите, Вы можете добавить информацию о дате/времени к именам файлов журналов путем включения их во имя: `{yyyy}` для полный год, `{yy}` для сокращенный год, `{mm}` для месяц, `{dd}` для день, `{hh}` для час.*

*Примеры:*
- *`logfile='captcha.{yyyy}-{mm}-{dd}-{hh}.txt'`*

##### «signature_limit»
- Максимально допустимое количество сигнатурей перед снятием CAPTCHA. Стандарт = 1.

##### «api»
- Какой API использовать?

```
api
├─recaptcha
│ ├─V2
│ └─Invisible
└─hcaptcha
  ├─V1
  └─Invisible
```

*Примечание для пользователей в Европейском Союзе: Когда CIDRAM сконфигурирован для использования файлов куки (например, когда «lockuser» является true/истинным), предупреждение о печенье отображается на странице в соответствии с требованиями [законодательства ЕС по куки](https://www.cookielaw.org/the-cookie-law/). Однако при использовании invisible API, CIDRAM пытается автоматически выполнить CAPTCHA для пользователя, и в случае успеха, это может привести к перезагрузке страницы и созданию куки без предоставления пользователю достаточного времени для фактического просмотра предупреждения о куки.*

##### «show_cookie_warning»
- Показать предупреждение о файлах куки? True = Да [Стандарт]; False = Нет.

*Эта директива конфигурации добавляется по запросу для пользователей, которые хотят отключить предупреждение о файлах куки, которое обычно отображается рядом с CAPTCHA (чтобы помочь например, скрыть любые признаки того, что CIDRAM используется). Тем не менее, я настоятельно рекомендую, чтобы большинство пользователей (особенно те, которые базируются в ЕС) оставляли его включенным.*

##### «show_api_message»
- Показать сообщение API? True = Да [Стандарт]; False = Нет.

*Это относится к любым дополнительным, несущественным сообщениям, отображаемым при блокировке запроса, кроме предупреждения куки.*

##### «nonblocked_status_code»
- Какой код состояния следует использовать при отображении CAPTCHA для неблокированных запросов?

Поддерживаемые значения:

Код состояния | Сообщение состояния
---|---
`200` | `200 OK`
`403` | `403 Forbidden`
`418` | `418 I'm a teapot`
`429` | `429 Too Many Requests`
`451` | `451 Unavailable For Legal Reasons`

#### «legal» (Категория)
Конфигурация, относящаяся к требованиям законодательства.

*Для получения дополнительной информации о правовых требованиях и о том, как это может повлиять на ваши требования к конфигурации, обратитесь к разделу «[ЛЕГАЛЬНАЯ ИНФОРМАЦИЯ](#user-content-SECTION11)» документации.*

##### «pseudonymise_ip_addresses»
- Псевдонимный IP-адреса при записи файлов журнала? True = Да [Стандарт]; False = Нет.

##### «omit_ip»
- Опустить IP-адреса из журналов? True = Да; False = Нет [Стандарт]. Примечание: «pseudonymise_ip_addresses» становится излишним, когда «omit_ip» является «true».

##### «omit_hostname»
- Опустить имена хостов из журналов? True = Да; False = Нет [Стандарт].

##### «omit_ua»
- Опустить пользовательские агенты из журналов? True = Да; False = Нет [Стандарт].

##### «privacy_policy»
- Адрес соответствующей политики конфиденциальности, отображаемый в нижнем колонтитуле любых сгенерированных страниц. Укажите URL-адрес, или оставьте пустым для отключения.

#### «template_data» (Категория)
Директивы/Переменные для шаблоны и темы.

Шаблонный данных относится к HTML-вывода, используемый для генерации «Доступ Закрыт» сообщения отображается для пользователей когда/на загрузки/уплоад файлов блокируются. Если Вы используете персонализированные темы для CIDRAM, HTML-выход получены из `template_custom.html` файл, а в противном случае, HTML-выход получены из `template.html` файл. Переменные, записанные в этом разделе файл конфигурации обрабатываются на HTML-выход в виде заменой любой имена переменных в окружении фигурных скобках найденный в HTML-вывода с соответствующей переменных данных. Например, где `foo="bar"`, любое вхождение `<p>{foo}</p>` найденный в HTML-вывода станет `<p>bar</p>`.

##### «theme»
- Стандартная тема для CIDRAM.

##### «magnification»
- *v1: «Magnification»*
- Увеличение шрифта. Стандарт = 1.

##### «css_url»
- Шаблонный файл для персонализированные темы использует внешние CSS свойства и шаблонный файл для стандарт тема использует внутренние CSS свойства. Поручить CIDRAM использовать персонализированные темы шаблонный файл, указать адрес публичного HTTP в CSS файлов вашей темы используя `css_url` переменная. Если оставить это переменная пустым, CIDRAM будет использовать шаблонный файл для стандарт тема.

#### «PHPMailer» (Категория)
Конфигурация PHPMailer.

В настоящее время CIDRAM использует PHPMailer только для двухфакторной аутентификации на фронтенд. Если вы не используете фронтенд, или если вы не используете двухфакторную аутентификацию для фронтенд, вы можете игнорировать эти директивы.

##### «event_log»
- *v1: «EventLog»*
- Файл для регистрации всех событий в отношении PHPMailer. Задайте имя файлу, или оставьте пустым чтобы деактивировать опцию.

##### «skip_auth_process»
- *v1: «SkipAuthProcess»*
- Установка этой директивы на `true` указывает PHPMailer пропустить обычный процесс проверки подлинности, который обычно возникает при отправке электронной почты через SMTP. Этого следует избегать, поскольку пропуская этот процесс может выдать исходящую электронную почту для атак MITM, но может потребоваться в тех случаях, когда этот процесс препятствует подключению PHPMailer к SMTP-серверу.

##### «enable_two_factor»
- *v1: «Enable2FA»*
- Эта директива включает/отключает использование 2FA для фронтенд счетов.

##### «host»
- *v1: «Host»*
- Хост SMTP используется для исходящей электронной почты.

##### «port»
- *v1: «Port»*
- Номер порта для исходящей электронной почты. Стандарт = 587.

##### «smtp_secure»
- *v1: «SMTPSecure»*
- Протокол для при отправке электронной почты через SMTP (TLS или SSL).

##### «smtp_auth»
- *v1: «SMTPAuth»*
- Эта директива включает/отключает аутентификацию сессия SMTP (обычно ее следует оставить в покое).

##### «username»
- *v1: «Username»*
- Имя пользователя для отправки электронной почты через SMTP.

##### «password»
- *v1: «Password»*
- Пароль для отправки электронной почты через SMTP.

##### «set_from_address»
- *v1: «setFromAddress»*
- Адрес отправителя для отправки электронной почты через SMTP.

##### «set_from_name»
- *v1: «setFromName»*
- Имя отправителя для отправки электронной почты через SMTP.

##### «add_reply_to_address»
- *v1: «addReplyToAddress»*
- Адрес ответа для отправки электронной почты через SMTP.

##### «add_reply_to_name»
- *v1: «addReplyToName»*
- Имя ответа для отправки электронной почты через SMTP.

#### «rate_limiting» (Категория)
Дополнительные директивы конфигурации для ограничения скорости.

Эта функция была реализована в CIDRAM, поскольку она была запрошена достаточным количеством пользователей, чтобы оправдать ее реализацию. Однако, поскольку это несколько выходит за рамки цели, первоначально предназначенной для CIDRAM, она, скорее всего, не понадобится большинству пользователей. Если вам требуется CIDRAM для ограничения скорости на вашем веб-сайте, эта функция может быть полезна для вас. Однако есть некоторые важные вещи, которые вы должны учитывать:
- Эта функция, как и все другие функции CIDRAM, будет работать только для страниц, защищенных CIDRAM. Таким образом, любые активы веб-сайта, специально не направленные через CIDRAM, не могут быть ограничены курсом CIDRAM.
- Если Вы можете использовать серверный модуль, cPanel, или какой-либо другой сетевой инструмент для обеспечения ограничения скорости, было бы лучше использовать это для ограничения скорости, вместо CIDRAM.
- Если конкретный пользователь очень хочет продолжить доступ к вашему сайту после ограничения скорости, в большинстве случаев им будет очень легко обойти ограничение скорости (например, если они меняют свой IP-адрес, или если они используют прокси или VPN, и предположив, что Вы настроили CIDRAM, чтобы не блокировать прокси и VPN, или что CIDRAM не знает прокси или VPN, которые они используют).
- Ограничение скорости может быть очень раздражающим для реальных, конечных пользователей. Это может быть необходимо, если ваша доступная полоса пропускания очень ограничена, и если вы обнаружите, что есть определенные источники трафика, которые еще не заблокированы, которые потребляют большую часть вашей доступной полосы пропускания. Но, если этого не требуется, его, вероятно, следует избегать.
- Иногда Вы рискуете блокировать законных пользователей или даже себя.

Если Вы считаете, что CIDRAM не требуется, чтобы обеспечить ограничение скорости для вашего веб-сайта, сохраните указанные ниже директивы в качестве значений по умолчанию. В противном случае Вы можете изменить свои значения в соответствии с вашими потребностями.

##### «max_bandwidth»
- Максимальный размер полосы пропускания, разрешенный в течение периода пособия, до включения ограничения скорости для будущих запросов. Значение 0 отключает этот тип ограничения скорости. Стандарт = 0KB.

##### «max_requests»
- Максимальное количество запросов, разрешенных в течение периода пособия, до включения ограничения скорости для будущих запросов. Значение 0 отключает этот тип ограничения скорости. Стандарт = 0.

##### «precision_ipv4»
- Точность использования при мониторинге использования IPv4. Значение отражает размер блока CIDR. Установить как 32 для наилучшей точности. Стандарт = 32.

##### «precision_ipv6»
- Точность использования при мониторинге использования IPv6. Значение отражает размер блока CIDR. Установить как 128 для наилучшей точности. Стандарт = 128.

##### «allowance_period»
- Количество часов для мониторинга использования. Стандарт = 0.

##### «exceptions»
- Исключения (т.е., запросы, которые не должны ограничиваться). Действует только при включенном ограничении скорости.
- *Доступные варианты: `Whitelisted,Verified`*

#### «supplementary_cache_options» (Категория)
Дополнительные параметры кэша.

##### «prefix»
- Указанное здесь значение будет добавлено в начало всех ключей записи кэша. По стандарту пустой. Когда на одном сервере существует несколько установок, это может быть полезно для хранения их кэшей отдельно.

##### «enable_apcu»
- Указывает, использовать ли APCu для кэширования. Стандарт = False.

##### «enable_memcached»
- Указывает, использовать ли Memcached для кэширования. Стандарт = False.

##### «enable_redis»
- Указывает, использовать ли Redis для кэширования. Стандарт = False.

##### «enable_pdo»
- Указывает, использовать ли PDO для кэширования. Стандарт = False.

##### «memcached_host»
- Значение хоста Memcached. Стандарт = «localhost».

##### «memcached_port»
- Значение порта Memcached. Стандарт = «11211».

##### «redis_host»
- Значение хоста Redis. Стандарт = «localhost».

##### «redis_port»
- Значение порта Redis. Стандарт = «6379».

##### «redis_timeout»
- Значение тайм-аута Redis. Стандарт = «2.5».

##### «pdo_dsn»
- Значение DSN PDO. Стандарт = «`mysql:dbname=cidram;host=localhost;port=3306`».

*Смотрите также: [Что такое «PDO DSN»? Как я могу использовать PDO с CIDRAM?](#user-content-HOW_TO_USE_PDO)*

##### «pdo_username»
- Имя пользователя PDO.

##### «pdo_password»
- Пароль PDO.

---


### 7. <a name="SECTION7"></a>СИГНАТУР ФОРМАТ

*Смотрите также:*
- *[Что такое «сигнатур»?](#user-content-WHAT_IS_A_SIGNATURE)*

#### 7.0 ОСНОВЫ (ДЛЯ ФАЙЛОВ СИГНАТУРЫ)

Все сигнатуры IPv4 придерживаться формат: `xxx.xxx.xxx.xxx/yy [Функция] [Параметр]`.
- `xxx.xxx.xxx.xxx` представляет начало блока CIDR (октеты для первым IP-адреса в блока).
- `yy` представляет размер блока CIDR [1-32].
- `[Функция]` инструктирует скрипт что делать с сигнатур (как сигнатур должны быть обработаны).
- `[Параметр]` представляет все что дополнительная информация что может потребоваться для `[Функция]`.

Все сигнатуры IPv6 придерживаться формат: `xxxx:xxxx:xxxx:xxxx::xxxx/yy [Функция] [Параметр]`.
- `xxxx:xxxx:xxxx:xxxx::xxxx` представляет начало блока CIDR (октеты для первым IP-адреса в блока). Полное обозначение и сокращенное обозначение являются приемлемыми (и каждый из них ДОЛЖЕН следовать соответствующим стандартам для обозначение IPv6, но с одним исключением: IPv6-адрес никогда не может начинаться с аббревиатуры когда использовании в сигнатуры для этого скрипт, из-за способа в котором они реконструируются посредством скрипт; Например, `::1/128` должны быть выражены, когда использовании в сигнатур, в виде `0::1/128`, и `::0/128` выражены в виде `0::/128`).
- `yy` представляет размер блока CIDR [1-128].
- `[Функция]` инструктирует скрипт что делать с сигнатур (как сигнатур должны быть обработаны).
- `[Параметр]` представляет все что дополнительная информация что может потребоваться для `[Функция]`.

CIDRAM сигнатурные файлы ДОЛЖЕН использовать разрыВы строк Unix-стиле (`%0A`, или `\n`)! Другие типы/стили разрыва строки (например, Windows `%0D%0A` или `\r\n` разрыВы строк, Mac `%0D` или `\r` разрыВы строк, и т.д.) МОЖЕТ быть использовано, но НЕ являются предпочтительными. РазрыВы строк не-Unix-стиле будут нормализованы к разрыВы строк Unix-стиле посредством скрипт.

Точное и правильное обозначение CIDR необходимо, в противном случае скрипт не будет признает сигнатур. Дополнительно, все сигнатуры CIDR для этого скрипт ДОЛЖНА начинаться с IP-адресом чья номер IP которого можно разделить равномерно в блок разделения представляющий от его размер блока CIDR (например, если Вы хотите чтобы заблокировать все IP-адреса из `10.128.0.0` к `11.127.255.255`, `10.128.0.0/8` НЕ будут признаны посредством скрипт, но `10.128.0.0/9` и `11.0.0.0/9` используется в сочетании, БУДУТ признаны посредством скрипт).

Все что в сигнатуры файлы которые не признается как качестве сигнатур ни как относятся синтаксис посредством скрипт будут ПРОИГНОРИРОВАНЫ, поэтому это означает что Вы можете безопасно поставить любые данные несигнатурного что Вы хочешь в файлов сигнатур без разбивая их и без разбивая скрипт. Комментарии являются приемлемыми в файлов сигнатур, без какого-либо специального форматирования требуется. Shell-стиле хэширования для комментарии является предпочтительным, но не принудительная; Функционально, это не имеет никакого значения для сценария ли или не Вы выбираете использовать хэширование Shell-стиле для комментарии, но использовать хэширование Shell-стиле может помогает IDE и простые текстовые редакторы чтобы правильно выделить различные части файлов сигнатур (и так, Shell-стиле хэширования может помочь в качестве наглядного пособия при редактировании).

В возможные значения для `[Функция]`:
- Run
- Whitelist
- Greylist
- Deny

Если «Run» используется, когда сигнатур срабатывает, скрипт будет пытаться выполнить (используя заявление `require_once`) внешний PHP скрипт, определяется значением `[Параметр]` (рабочий каталог должен быть каталог „/vault/“ из скрипт).

Примеры: `127.0.0.0/8 Run example.php`

Это может быть полезно если Вы хотите чтобы выполнить некоторые специфические PHP код для некоторых конкретных IP-адресов и/или CIDR.

Если «Whitelist» используется, когда сигнатур срабатывает, скрипт будет сброса всех обнаружений (если есть какие-либо обнаружений) и нарушить функцию тестирования. `[Параметр]` будут игнорироваться. Эта функция является эквивалентом белого списка конкретный IP или CIDR от обнаружения.

Примеры: `127.0.0.1/32 Whitelist`

Если «Greylist» используется, когда сигнатур срабатывает, скрипт будет сброса всех обнаружений (если есть какие-либо обнаружений) и перейти к следующему файлу сигнатуры чтобы продолжить обработку. `[Параметр]` будут игнорироваться.

Примеры: `127.0.0.1/32 Greylist`

Если «Deny» используется, когда сигнатур срабатывает, предполагая что не сигнатур из белый список были срабатывать для данного IP-адреса и/или данного CIDR, доступ к защищенной странице будет запрещен. «Deny» то что Вы хотите использовать на самом деле блокировать IP-адрес и/или диапазон CIDR. Когда какие-либо сигнатуры срабатывает которые используют «Deny», страница «Доступ Закрыт» из скрипт будет генерироваться и запрос на защищенной странице убит.

Значение `[Параметр]` принимаются с «Deny» будут обрабатываться на страницы для «Доступ Закрыт», поставляется клиенту/пользователю как цитируется причиной их доступа к запрашиваемой странице закрытия. Это может быть коротким и простым предложением, объясняя почему Вы выбрали чтобы блокировать их (что-нибудь должно хватить, даже простой „Я не хочу чтобы Ты на моем сайте“), или один из небольшой кучки сокращённых слов поставляемые из сценария, что если используется, будет заменен скриптом с предварительно подготовленной объяснения для почему клиент/пользователь был заблокирован.

Предварительно подготовленные объяснения имеют поддержку L10N и может быть переведен с помощью скриптом основанный на языке который Вы укажете в директиве `lang` для конфигурации скрипт. Дополнительно, Вы можете поручить скрипт игнорировать сигнатуры с «Deny» на основе их значение `[Параметр]` (если они используют эти сокращенные слова) с помощью директив определяется конфигурацией скриптом (каждая сокращенная слово имеет соответствующую директиву чтобы обрабатывать соответствующие сигнатуриь или игнорировать их). Значение `[Параметр]` которые не используют эти сокращенные слова, однако, не имеют поддержку L10N и поэтому не будет переведен с помощью скриптом, и дополнительно, непосредственно не контролируется с конфигурацией скрипт.

Доступные сокращенные слова:
- Attacks
- Bogon
- Cloud
- Generic
- Legal
- Malware
- Proxy
- Spam

#### 7.1 ТЕГИ

##### 7.1.0 ТЕГИ СЕКЦИЙ

Если Вы хотите разделить ваши собственные сигнатуры на отдельные секции, Вы можете идентифицировать эти отдельные секции к скрипт путем добавления «теги секций» сразу же после того как сигнатуры каждого секция, наряду с названием вашей сигнатур секция (смотрите пример ниже).

```
# Секция 1.
1.2.3.4/32 Deny Bogon
2.3.4.5/32 Deny Cloud
4.5.6.7/32 Deny Generic
5.6.7.8/32 Deny Spam
6.7.8.9/32 Deny Proxy
Tag: Секция 1
```

Чтобы разорвать теги секций и для обеспечения что теги не идентифицированы неправильно для сигнатур секции от ранее в файлов сигнатур, просто убедитесь что есть по крайней мере два последовательных разрывы строк между тегом и ваших предыдущих сигнатур секции. Любые сигнатуры без тегов будут «IPv4» или «IPv6» в стандарта (в зависимости от того, какие типы сигнатур срабатывает).

```
1.2.3.4/32 Deny Bogon
2.3.4.5/32 Deny Cloud

4.5.6.7/32 Deny Generic
5.6.7.8/32 Deny Spam
Tag: Секция 1
```

В приведенном выше примере, `1.2.3.4/32` и `2.3.4.5/32` будут помечены как «IPv4», в то время как `4.5.6.7/32` и `5.6.7.8/32` будут помечены как «Секция 1».

Та же логика может применяться и для разделения других типов тегов.

В частности, теги секций могут быть очень полезны для отладки при возникновении ложных срабатываний, обеспечивая легкое средство поиска точного источника проблемы, и может быть очень полезна для фильтрации записей в файле журнала при просмотре файлов журнала через фронтенд (имена секций можно щелкнуть по странице журналов фронтенд и их можно использовать в качестве критерия фильтрации). Если теги секций опущены для некоторых определенных сигнатурей, когда эти сигнатуры запускаются, CIDRAM использует имя файла сигнатуры вместе с типом заблокированного IP-адреса (IPv4 или IPv6) в качестве отказоустойчивый, и таким образом, теги секций полностью необязательны. В некоторых случаях они могут быть рекомендованы, например, когда файлы сигнатуры смутно названы или когда в противном случае может быть трудно четко идентифицировать источник сигнатурей, в результате чего запрос блокируется.

##### 7.1.1 ТЕГИ ИСТЕЧЕНИЯ

Если Вы хотите сигнатуры чтобы истекают через какое-то время, аналогичным способом к теги секций, Вы можете использовать «истечение теги» чтобы указать когда сигнатур должна перестать быть действительным. Истечение теги используют формат «ГГГГ.ММ.ДД» (смотрите пример ниже).

```
# Секция 1.
1.2.3.4/32 Deny Generic
2.3.4.5/32 Deny Generic
Expires: 2016.12.31
```

Истекшие сигнатуры никогда не будут инициироваться ни при каких запросах, несмотря ни на что.

##### 7.1.2 ТЕГИ ПРОИСХОЖДЕНИЯ

Если Вы хотите указать страну происхождения для какой-либо определенной сигнатуры, вы можете сделать это, используя «тег происхождения». Тег происхождения принимает код «[ISO 3166-1 Alpha-2](https://ru.wikipedia.org/wiki/ISO_3166-1_alpha-2)», соответствующий стране происхождения для сигнатурей, к которым он относится. Эти коды должны быть написаны в верхнем регистре (в нижнем или смешанном случае не будут отображаться правильно). Когда используется тег происхождения, он добавляется в запись поля «Почему Заблокированные» для любых запросов, заблокированных в результате сигнатурей, к которым применяется тег.

Если установлен дополнительный компонент «flags CSS», при просмотре лог-файлов через страницу журналов фронтенд, информация, добавленная тегами происхождения, заменяется флагом страны, соответствующей этой информации. Эта информация, будь то в ее необработанном виде или в качестве флага страны, доступна для кликов, а при нажатии, будет фильтровать записи в журнале посредством других аналогичных идентификационных записей журнала (эффективно позволяя тем, кто обращается к странице журналов, фильтровать по стране происхождения).

Примечание: Технически это не какая-либо форма геолокации, из-за чего она не предполагает поиска какой-либо конкретной информации, относящейся к входящим IP-адресам, а скорее просто позволяет нам явно указать страну происхождения для любых запросов, заблокированных конкретными сигнатурами. В одном секция сигнатуры допустимы несколько тегов происхождения.

Гипотетический пример:

```
1.2.3.4/32 Deny Generic
Origin: CN
2.3.4.5/32 Deny Generic
Origin: FR
4.5.6.7/32 Deny Generic
Origin: DE
6.7.8.9/32 Deny Generic
Origin: US
Tag: Foobar
```

Любые теги могут использоваться совместно, и все теги являются необязательными (смотрите пример ниже).

```
# Пример Секция.
1.2.3.4/32 Deny Generic
Origin: US
Tag: Пример Секция
Expires: 2016.12.31
```

##### 7.1.3 ТЕГИ ОТЛОЖЕННЫЕ

Когда большое количество файлов сигнатур установлено и активно используется, инсталляция могут стать довольно сложными, и могут быть некоторые сигнатуры, которые перекрываются. В этих случаях для предотвращения включения нескольких перекрывающихся сигнатурей во время блочных событий, отложенные теги могут использоваться для отсрочки определенных секция сигнатуры в случаях, когда установлен и активно используется какой-либо другой файл сигнатур. Это может быть полезно в случаях, когда некоторые сигнатуры обновляются чаще других, чтобы отложить менее часто обновляемые сигнатуры в пользу более часто обновляемых сигнатурей.

Отложенные теги используются аналогично другим типам тегов. Значение тега должно соответствовать установленному и активно используемому файлу сигнатуры, от которого будет отложено.

Пример:

```
1.2.3.4/32 Deny Generic
Origin: AA
2.3.4.5/32 Deny Generic
Origin: BB
Defers to: preferred_signatures.dat
```

##### 7.1.4 ТЕГИ ПРОФИЛЯ

Теги профиля позволяют отображать дополнительную информацию на тестовой странице IP и могут использоваться модулями и вспомогательными правилами для более сложного поведения и принятия точных решений.

Теги профиля используются так же, как и другие типы тегов. Значения тегов профиля могут использоваться как условие для модулей и вспомогательных правил. Теги профиля могут предоставлять несколько значений, разделяя их точкой с запятой. Конечный пользователь никогда не видит значения тегов профиля.

Пример:

```
1.2.3.4/32 Deny Generic
2.3.4.5/32 Deny Generic
Profile: Example;Just some generic stuff;Foo;Bar
Origin: BB
```

#### 7.2 YAML

##### 7.2.0 ОСНОВЫ YAML

Упрощенная форма маркап YAML может быть использован в сигнатур файлы для целей определения поведения и установок специфичные для отдельных сигнатур секций. Это может быть полезно если Вы хотите чтобы значение ваших директив конфигурации отличаться на основе индивидуальных сигнатур и сигнатур секций (например; если Вы хотите чтобы предоставить адрес электронной почты для поддержки билетов для любых пользователей что заблокированных с помощью один специфична сигнатур, но не хотите чтобы предоставить адрес электронной почты для поддержки билетов для пользователей что заблокированных с помощью любых других сигнатур; если Вы хотите чтобы некоторые специфический сигнатур чтобы вызвать страницу перенаправления; если Вы хотите чтобы отметить секция сигнатур для использования с reCAPTCHA/hCAPTCHA; если Вы хотите чтобы войти блокировал попытки доступа к отдельным файлам на основе индивидуальных сигнатурей и/или сигнатур секций).

Применение маркап YAML в файлов сигнатур совершенно не обязательно (то есть, Вы можете использовать его, если Вы хотите сделать это, но Вы не обязаны делать это), и способен использовать большинство (но не все) директивы конфигурации.

Заметка: Имплементация в CIDRAM для маркап YAML очень упрощенно и очень ограничено; Это предназначен для выполнения требований конкретных для CIDRAM таким образом что имеет знакомство с маркап YAML, но не следует ни соответствует официальным спецификациям (и поэтому не будет вести себя так же как более тщательный имплементации в другом месте, и может не подходить для других проектов в другом месте).

В CIDRAM, сегменты маркап YAML определены для скрипт с тремя черточками („---“), и заканчиваются вместе со содержащими сигнатур секций с разрывы строк двойной. Типичный сегмент маркап YAML в сигнатуры секция состоит из трех черточек на строка сразу же после того как список CIDR и любые теги, с последующим двухмерной списка пары ключ-значение (первое измерение, категории директива конфигурации; второе измерение, директива конфигурации) для которых директивы конфигурации должны быть изменены (и какие ценности) всякий раз когда сигнатуры в этом сигнатур секция срабатывании (см ниже примеры).

```
# Foobar 1.
1.2.3.4/32 Deny Generic
2.3.4.5/32 Deny Generic
4.5.6.7/32 Deny Generic
Tag: Foobar 1
---
general:
 logfile: logfile.{yyyy}-{mm}-{dd}.txt
 logfile_apache: access.{yyyy}-{mm}-{dd}.txt
 logfile_serialized: serial.{yyyy}-{mm}-{dd}.txt
 forbid_on_block: false
 emailaddr: username@domain.tld
recaptcha:
 lockip: false
 lockuser: true
 expiry: 720
 logfile: recaptcha.{yyyy}-{mm}-{dd}.txt
 enabled: true
template_data:
 css_url: https://domain.tld/cidram.css

# Foobar 2.
1.2.3.4/32 Deny Generic
2.3.4.5/32 Deny Generic
4.5.6.7/32 Deny Generic
Tag: Foobar 2
---
general:
 logfile: "logfile.Foobar2.{yyyy}-{mm}-{dd}.txt"
 logfile_apache: "access.Foobar2.{yyyy}-{mm}-{dd}.txt"
 logfile_serialized: "serial.Foobar2.{yyyy}-{mm}-{dd}.txt"
 forbid_on_block: 503

# Foobar 3.
1.2.3.4/32 Deny Generic
2.3.4.5/32 Deny Generic
4.5.6.7/32 Deny Generic
Tag: Foobar 3
---
general:
 forbid_on_block: 403
 silent_mode: "http://127.0.0.1/"
```

##### 7.2.1 КАК «СПЕЦИАЛЬНО ОТМЕТИТЬ» СИГНАТУР СЕКЦИЙ ДЛЯ ИСПОЛЬЗОВАНИЯ С reCAPTCHA/hCAPTCHA

Когда «usemode» является 2 или 5, чтобы «специально отметить» сигнатур секций для использования с reCAPTCHA/hCAPTCHA, запись включается в сегменте YAML для этого секция сигнатуры (смотрите пример ниже).

```
1.2.3.4/32 Deny Generic
2.3.4.5/32 Deny Generic
Tag: CAPTCHA Marked
---
recaptcha:
 enabled: true
hcaptcha:
 enabled: true
```

#### 7.3 ВСПОМОГАТЕЛЬНЫЙ

##### 7.3.0 ИГНОРИРОВАНИЕ СЕКЦИЯ СИГНАТУРЫ

К тому же, если Вы хотите CIDRAM полностью игнорировать некоторые конкретные секций в любой из сигнатур файлы, Вы можете использовать файл `ignore.dat` чтобы указать какие секций игнорировать. На новой строка, писать `Ignore`, а затем пробел, а затем название секций что Вы хотите CIDRAM игнорировать (смотрите пример ниже).

```
Ignore Секция 1
```

Это также может быть достигнуто с помощью интерфейса, предоставленного на странице «списка секций» на фронтенд в CIDRAM.

##### 7.3.1 ВСПОМОГАТЕЛЬНЫЕ ПРАВИЛА

Если Вы считаете, что писать собственные файлы сигнатуры или настраиваемые модули слишком сложны для вас, более простой альтернативой может быть использование интерфейса, предоставляемого страницей «вспомогательных правил» на фронтенде CIDRAM. Выбрав соответствующие параметры и указав детали о конкретных типах запросов, вы можете указать CIDRAM, как реагировать на эти запросы. «Вспомогательные правила» выполняются после того, как все файлы сигнатур и модули уже завершены.

#### 7.4 <a name="MODULE_BASICS"></a>ОСНОВЫ (ДЛЯ МОДУЛИ)

Модули могут использоваться для расширения функциональности CIDRAM, выполнения дополнительных задач, или обработки дополнительной логики.

Из-за того что модули написаны в виде файлов PHP, если Вы хорошо знакомы с кодовой базой CIDRAM, Вы можете структурировать свои модули, и писать свои сигнатуры модуля, как Вы хотите (в рамках того, что возможно с PHP).

*Заметка: Если вам неудобно работать с кодом PHP, писать собственные модули не рекомендуется.*

Некоторые функции предоставляются CIDRAM для использования модулей, что упрощает создание собственных модулей. Информация об этой функциональности описана ниже.

#### 7.5 ФУНКЦИОНАЛЬНОСТЬ МОДУЛЯ

##### 7.5.0 «$Trigger»

Сигнатуры модулей обычно пишутся с помощью `$Trigger`. В большинстве случаев это closure будет более важным, чем что-либо еще для написания модулей.

`$Trigger` принимает 4 параметра: `$Condition`, `$ReasonShort`, `$ReasonLong` (необязательно), и `$DefineOptions` (необязательно).

Оценивается правдоподобность `$Condition`, и если «true», сигнатур «срабатывает». Если «false», сигнатур *не* «срабатывает». `$Condition` обычно содержит PHP-код для оценки состояния, которое должно вызвать блокировку запроса.

`$ReasonShort` указывается в поле «Почему Заблокированные», когда сигнатур «срабатывает».

`$ReasonLong` – Это необязательное сообщение, которое будет отображаться пользователю/клиенту, когда они заблокированы, чтобы объяснить, почему они были заблокированы. По умолчанию используется стандартное сообщение «Доступ Закрыт» при его отсутствии.

`$DefineOptions` – Это необязательный массив, содержащий пары ключ/значение, используемые для определения параметров конфигурации, специфичных для инстанция запроса. Параметры конфигурации будут применены, когда сигнатур будет срабатывает.

`$Trigger` возвращает «true», когда сигнатур «срабатывает», а когда нет, «false».

Чтобы использовать это closure в своем модуле, помните, во-первых, чтобы наследовать его из родительской области:
```PHP
$Trigger = $CIDRAM['Trigger'];
```

##### 7.5.1 «$Bypass»

Байпасы сигнатуры обычно пишутся с помощью `$Bypass`.

`$Bypass` принимает 3 параметра: `$Condition`, `$ReasonShort`, и `$DefineOptions` (необязательно).

Оценивается правдоподобность `$Condition`, и если «true», сигнатур «срабатывает». Если «false», байпас *не* «срабатывает». `$Condition` обычно содержит PHP-код для оценки состояния, которое *не* должно вызвать блокировку запроса.

`$ReasonShort` указывается в поле «Почему Заблокированные», когда байпас «срабатывает».

`$DefineOptions` – Это необязательный массив, содержащий пары ключ/значение, используемые для определения параметров конфигурации, специфичных для инстанция запроса. Параметры конфигурации будут применены, когда байпас будет срабатывает.

`$Bypass` возвращает «true», когда байпас «срабатывает», а когда нет, «false».

Чтобы использовать это closure в своем модуле, помните, во-первых, чтобы наследовать его из родительской области:
```PHP
$Bypass = $CIDRAM['Bypass'];
```

##### 7.5.2 «$CIDRAM['DNS-Reverse']»

Это можно использовать для получения имени хоста IP-адреса. Если Вы хотите создать модуль для блокирования имен хостов, это закрытие может быть полезно.

Пример:
```PHP
<?php
/** Inherit trigger closure (see functions.php). */
$Trigger = $CIDRAM['Trigger'];

/** Fetch hostname. */
if (empty($CIDRAM['Hostname'])) {
    $CIDRAM['Hostname'] = $CIDRAM['DNS-Reverse']($CIDRAM['BlockInfo']['IPAddr']);
}

/** Example signature. */
if ($CIDRAM['Hostname'] && $CIDRAM['Hostname'] !== $CIDRAM['BlockInfo']['IPAddr']) {
    $Trigger($CIDRAM['Hostname'] === 'www.foobar.tld', 'Foobar.tld', 'Hostname Foobar.tld is not allowed.');
}
```

#### 7.6 МОДУЛЬНЫЕ ПЕРЕМЕННЫЕ

Модули выполняются в пределах своей собственной области действия, а любые переменные, определенные модулем, не будут доступны для других модулей, или родительскому скрипту, если они не хранятся в массиве `$CIDRAM` (все остальное очищается после завершения выполнения модуля).

Ниже перечислены некоторые общие переменные, которые могут быть полезны для вашего модуля:

Переменная | Описание
----|----
`$CIDRAM['BlockInfo']['DateTime']` | Текущая дата и время.
`$CIDRAM['BlockInfo']['IPAddr']` | IP-адрес для текущего запроса.
`$CIDRAM['BlockInfo']['ScriptIdent']` | Версия сценария CIDRAM.
`$CIDRAM['BlockInfo']['Query']` | Запрос текущего запроса.
`$CIDRAM['BlockInfo']['Referrer']` | Ссылка для текущего запроса (если таковая существует).
`$CIDRAM['BlockInfo']['UA']` | Пользовательский агент для текущего запроса.
`$CIDRAM['BlockInfo']['UALC']` | Пользовательский агент для текущего запроса (в нижнем регистре).
`$CIDRAM['BlockInfo']['ReasonMessage']` | Сообщение, которое будет отображаться пользователю/клиенту для текущего запроса, если они заблокированы.
`$CIDRAM['BlockInfo']['SignatureCount']` | Количество сигнатурей, инициированных для текущего запроса.
`$CIDRAM['BlockInfo']['Signatures']` | Справочная информация для любых сигнатур, инициированных для текущего запроса.
`$CIDRAM['BlockInfo']['WhyReason']` | Справочная информация для любых сигнатур, инициированных для текущего запроса.

---


### 8. <a name="SECTION8"></a>ИЗВЕСТНЫЕ ПРОБЛЕМЫ СОВМЕСТИМОСТИ

Было обнаружено, что следующие пакеты и продукты несовместимы с CIDRAM:
- __[Endurance Page Cache](https://github.com/CIDRAM/CIDRAM/issues/52)__
- __[Mix.com](https://github.com/CIDRAM/CIDRAM/issues/80)__

Модули были доступны для обеспечения совместимости следующих пакетов и продуктов с CIDRAM:
- __[BunnyCDN](https://github.com/CIDRAM/CIDRAM/issues/56)__

*Смотрите также: [Графики Совместимости](https://maikuolan.github.io/Compatibility-Charts/).*

---


### 9. <a name="SECTION9"></a>ЧАСТО ЗАДАВАЕМЫЕ ВОПРОСЫ (FAQ)

- [Что такое «сигнатур»?](#user-content-WHAT_IS_A_SIGNATURE)
- [Что такое «CIDR»?](#user-content-WHAT_IS_A_CIDR)
- [Что такое «ложноположительный»?](#user-content-WHAT_IS_A_FALSE_POSITIVE)
- [Может CIDRAM блокировать целые страны?](#user-content-BLOCK_ENTIRE_COUNTRIES)
- [Как часто обновляются сигнатуры?](#user-content-SIGNATURE_UPDATE_FREQUENCY)
- [Я столкнулся с проблемой при использовании CIDRAM, и я не знаю, что с этим делать! Пожалуйста помоги!](#user-content-ENCOUNTERED_PROBLEM_WHAT_TO_DO)
- [Я заблокирован CIDRAM с веб-сайта, который я хочу посетить! Пожалуйста помоги!](#user-content-BLOCKED_WHAT_TO_DO)
- [Я хочу использовать CIDRAM (до v2) с версией PHP ниже 5.4.0; Вы можете помочь?](#user-content-MINIMUM_PHP_VERSION)
- [Я хочу использовать CIDRAM (v2) с версией PHP ниже 7.2.0; Вы можете помочь?](#user-content-MINIMUM_PHP_VERSION_V2)
- [Могу ли я использовать одну установку CIDRAM для защиты нескольких доменов?](#user-content-PROTECT_MULTIPLE_DOMAINS)
- [Я не хочу возиться с установкой этого и заставить его работать с моим сайтом; Могу я просто заплатить вам за все это?](#user-content-PAY_YOU_TO_DO_IT)
- [Могу ли я нанять вас или любого из разработчиков этого проекта для частной работы?](#user-content-HIRE_FOR_PRIVATE_WORK)
- [Мне нужны модификации специалиста, настройки и т.д.; Вы можете помочь?](#user-content-SPECIALIST_MODIFICATIONS)
- [Я разработчик, веб-дизайнер, или программист. Могу ли я принять или предложить работу, связанную с этим проектом?](#user-content-ACCEPT_OR_OFFER_WORK)
- [Я хочу внести свой вклад в проект; Я могу сделать это?](#user-content-WANT_TO_CONTRIBUTE)
- [Могу ли я использовать cron для автоматического обновления?](#user-content-CRON_TO_UPDATE_AUTOMATICALLY)
- [Что такое «нарушения»?](#user-content-WHAT_ARE_INFRACTIONS)
- [Может ли CIDRAM блокировать имена хостов?](#user-content-BLOCK_HOSTNAMES)
- [Что я могу использовать для «default_dns»?](#что-я-могу-использовать-для-default_dns)
- [Могу ли я использовать CIDRAM для защиты других вещей, помимо веб-сайтов (например, серверов электронной почты, FTP, SSH, IRC и т.д.)?](#user-content-PROTECT_OTHER_THINGS)
- [Будут ли возникать проблемы, если я буду использовать CIDRAM одновременно с использованием CDN или кэширования?](#user-content-CDN_CACHING_PROBLEMS)
- [Будет ли CIDRAM защищать мой сайт от атак DDoS?](#user-content-DDOS_ATTACKS)
- [Когда я активирую или деактивирую модули или файлы сигнатуры на странице обновлений, он сортирует их по алфавиту в конфигурации. Могу ли я изменить способ сортировки?](#user-content-CHANGE_COMPONENT_SORT_ORDER)
- [Что такое «PDO DSN»? Как я могу использовать PDO с CIDRAM?](#user-content-HOW_TO_USE_PDO)
- [CIDRAM блокирует cronjobs; Как это исправить?](#user-content-BLOCK_CRON)

#### <a name="WHAT_IS_A_SIGNATURE"></a>Что такое «сигнатур»?

В контексте CIDRAM, «сигнатур» относится к данным, которые служат индикатора/идентификатора, для чего-то конкретного что мы ищем, обычно IP-адрес или CIDR, и включает в себя некоторые инструкции для CIDRAM, говоря это лучший способ ответить когда сталкивается с тем что мы ищем. Типичная сигнатур для CIDRAM выглядит примерно так:

Для «файлов сигнатуры»:

`1.2.3.4/32 Deny Generic`

Для «модули»:

```PHP
$Trigger(strpos($CIDRAM['BlockInfo']['UA'], 'Foobar') !== false, 'Foobar-UA', 'User agent "Foobar" not allowed.');
```

*Заметка: Сигнатуры для «файлов сигнатуры» и сигнатуры для «модули» – Это не одно и то же.*

Часто (но не всегда), сигнатуры будут объединены в группы, Формирование «сигнатур секций», часто сопровождается комментариями, маркуп, и/или связанные метаданные, которые могут быть использованы для обеспечения дополнительного контекста для сигнатуры и/или дальнейшей инструкции.

#### <a name="WHAT_IS_A_CIDR"></a>Что такое «CIDR»?

«CIDR» является акронимом для «Classless Inter-Domain Routing» („Бесклассовая адресация“) *[[1](https://ru.wikipedia.org/wiki/%D0%91%D0%B5%D1%81%D0%BA%D0%BB%D0%B0%D1%81%D1%81%D0%BE%D0%B2%D0%B0%D1%8F_%D0%B0%D0%B4%D1%80%D0%B5%D1%81%D0%B0%D1%86%D0%B8%D1%8F), [2](https://whatismyipaddress.com/cidr)]*, и это акроним, который используется как часть имени этого пакета, «CIDRAM», который является акронимом для «Classless Inter-Domain Routing Access Manager» („Бесклассовая Адресация Доступа Менеджер“).

Однако, в контексте CIDRAM (таких как, в этой документации, в рамках обсуждений касающихся CIDRAM, или в данных языка CIDRAM), когда «CIDR» (единственное число) или «CIDRы» (множественное число) упоминается (и поэтому, посредством чего мы используем эти слова как существительные в своем собственном праве, в отличие от акронимов), наш смысл и намерение: Подсеть (или подсетей), выраженные с использованием нотации CIDR. Причина по которой CIDR (или CIDRы) используется вместо подсети (или подсетей): Чтобы уточнить, что это специально подсети, выраженные с использованием нотации CIDR, которая ссылается на (потому нотации CIDR только один из нескольких способов, которыми подсети могут быть выражены). Поэтому CIDRAM можно считать «подсети доступа менеджер».

Хотя это двойное значение «CIDR» может представлять некоторую двусмысленность в некоторых случаях, это объяснение, наряду с предоставленным контекстом, должен помочь решить такую двусмысленность.

#### <a name="WHAT_IS_A_FALSE_POSITIVE"></a>Что такое «ложноположительный»?

Термин «ложноположительный» (*альтернативно: «ложноположительными ошибка»; «ложная сигнализация»*; Английский: *false positive*; *false positive error*; *false alarm*), описал очень просто, и в обобщенном контексте, используется при проверке условия, для ссылаясь на результаты этого теста, когда результаты будут положительный (то есть, условия определяется будут «положительный», или «истинно»), но как ожидается будет (или должно было) отрицательный (то есть, условие, в действительности, является «отрицательный», или «ложно»). Термин «ложноположительный» можно было бы считать аналогом «плачет волк» (английский идиома в которой условие проверяется является ли там волк возле стада, условие является «ложно» в том, что нет никакого волка возле стада, и условие сообщается «положительный» посредством пастух путем кричать «волк, волк»), или аналогично ситуации в медицинском тестировании в которой пациент диагностирован как какую-то болезнь, когда в действительности, у них нет болезни.

Связанные результаты при проверке условия можно описать с использование терминов «истинноположительный», «истинноотрицательный» и «ложноотрицательный». «Истинноположительный» описывает когда результаты испытаний и фактическое состояние условия оба являются истинными (или положительные), и «истинноотрицательный» описывает когда результаты испытаний и фактическое состояние условия оба являются ложными (или отрицательные); «Истинноположительный» или «истинноотрицательный» рассматриваются как «правильный вывод». Противоположностью «ложноположительный» является «ложноотрицательный»; «Ложноотрицательный» описывает когда результаты испытаний отрицательные (то есть, условие определяется как отрицательные, или ложными), но как ожидается будет (или должно было) положительные (то есть, условие, в действительности, является «положительный», или «истинно»).

В контексте CIDRAM, эти термины относятся к сигнатур CIDRAM и что/кого они блокируют. Когда CIDRAM блокирует IP-адрес из-за плохой, устаревшей или неправильной сигнатур, но не должно быть сделано, или когда он делает это по неправильным причинам, мы называем это событие как «ложноположительный». Когда CIDRAM не удается блокировать IP-адрес, который должен был быть заблокированы, из-за непредвиденных угроз, недостающие сигнатур или недостатки в своих сигнатурей, мы называем это событие как «обнаружение не удалось» (аналогична «ложноотрицательный»).

Это может быть суммированы в таблице ниже:

&nbsp; | CIDRAM *НЕ* должны блокировать IP-адрес | CIDRAM *ДОЛЖНЫ* блокировать IP-адрес
---|---|---
CIDRAM *НЕ* блокирует IP-адрес | Истинноотрицательный (правильный вывод) | Обнаружение не удалось (аналогична ложноотрицательный)
CIDRAM *ДЕЛАЕТ* блокирует IP-адрес | __Ложноположительный__ | Истинноположительный (правильный вывод)

#### <a name="BLOCK_ENTIRE_COUNTRIES"></a>Может CIDRAM блокировать целые страны?

Да. Самый простой способ сделать это - Установить модуль BGPView и настроить его в соответствии с вашими потребностями.

#### <a name="SIGNATURE_UPDATE_FREQUENCY"></a>Как часто обновляются сигнатуры?

Частота обновления зависит от файлов сигнатур. Предпринята попытка обновить файлов сигнатур в максимально возможной степени, но, потому всех нас есть различные другие обязательства, наша жизнь вне проекта, и мы не получаем материальной компенсации (т.е., оплата) за наши усилия по проекту, точный график обновления не может быть гарантирован. В общем, обновления происходят, когда есть время, и мы стараемся расставить приоритеты на основе необходимости и частота изменения между диапазонами. Помощь всегда приветствуется, если Вы готовы предложить любую.

#### <a name="ENCOUNTERED_PROBLEM_WHAT_TO_DO"></a>Я столкнулся с проблемой при использовании CIDRAM, и я не знаю, что с этим делать! Пожалуйста помоги!

- Используете ли Вы последнюю версию программного обеспечения? Используете ли Вы последние версии ваших файлов сигнатуры? Если ответ на любой из этих двух вопросов отрицательный, попробуйте сначала обновить все, и попытайтесь решить проблема. Если оно сохраняется, продолжайте чтение.
- Вы проверили всю документацию? Если нет, сделайте это. Если проблема не может быть решена с помощью документации, продолжите чтение.
- Вы проверили **[странице «issues»](https://github.com/CIDRAM/CIDRAM/issues)**, чтобы узнать упоминалась ли эта проблема ранее? Если это было уже упоминалось, проверить были ли предоставлены какие-либо предложения, идеи и/или решения, и следуйте по необходимости чтобы попытаться решить проблема.
- Если проблема не решена, пожалуйста, обратитесь за помощью, создав новую «issue» на странице «issues».

#### <a name="BLOCKED_WHAT_TO_DO"></a>Я заблокирован CIDRAM с веб-сайта, который я хочу посетить! Пожалуйста помоги!

CIDRAM предоставляет владельцам веб-сайтов возможность блокировать нежелательный трафик, но владельцы веб-сайтов обязаны сами решать, как они хотят использовать CIDRAM. В случае ложноположительный, файлами сигнатуры обычно включается в CIDRAM, поправки могут быть сделаны, но в отношении того чтобы быть разблокированным с определенных веб-сайтов, Вам необходимо связаться с владельцами этих веб-сайтов. В случаях когда исправления сделаны, по крайней мере, они должны будут обновить свои файлов сигнатур и/или инсталляция, и в других случаях (таких как, например, когда они есть модифицировал свою инсталляция, создали свои собственные сигнатуры, и т.д.), ответственность за решение вашей проблемы полностью принадлежит им, и полностью вне нашего контроля.

#### <a name="MINIMUM_PHP_VERSION"></a>Я хочу использовать CIDRAM (до v2) с версией PHP ниже 5.4.0; Вы можете помочь?

Нет. PHP >= 5.4.0 является минимальным требованием для CIDRAM < v2.

#### <a name="MINIMUM_PHP_VERSION_V2"></a>Я хочу использовать CIDRAM (v2) с версией PHP ниже 7.2.0; Вы можете помочь?

Нет. PHP >= 7.2.0 является минимальным требованием для CIDRAM v2.

*Смотрите также: [Графики Совместимости](https://maikuolan.github.io/Compatibility-Charts/).*

#### <a name="PROTECT_MULTIPLE_DOMAINS"></a>Могу ли я использовать одну установку CIDRAM для защиты нескольких доменов?

Да. CIDRAM инсталляций не привязаны к определенным домены, и поэтому может использоваться для защиты нескольких доменов. В общем, мы ссылаемся на CIDRAM инсталляций, защищающие только один домен, как «однодоменные инсталляций», и мы ссылаемся на CIDRAM инсталляций, защищающие несколько доменов и/или поддоменов, как «многодоменные инсталляций». Если Вы используете многодоменную инсталляция, и необходимо использовать разные файлы сигнатур для разных доменов, или необходимо настроить CIDRAM по-разному для разных доменов, это можно сделать. После загрузки файла конфигурации (`config.ini`), CIDRAM проверит наличие «файл переопределения конфигурации» специфичные для запрашиваемого домена или поддомена (`xn----7sbaabjijgdno9cdqkbchu3o.tld.config.ini`), и если он будет найден, любые значений конфигурации, определенные в файл переопределения конфигурации, будет использоваться для экземпляра выполнения вместо значений конфигурации, определенных конфигурационным файлом. Конфигурация переопределяет файлы, идентичные конфигурационному файлу, и на Ваше усмотрение, Может содержать все директивы конфигурации, доступные для CIDRAM, или какой бы небольшой подсекция требуется, при необходимости. Имена для конфигурация переопределяет файлов соответствуют домену для которого они предназначены (так, например, если Вам нужен файл переопределения конфигурации для домена, `https://www.some-domain.tld/`, его файл переопределения конфигурации должен иметь имя `some-domain.tld.config.ini`, и должен быть помещен в `vault`, вместе с файлом конфигурации, `config.ini`). Доменные имена извлекаются из заголовка `HTTP_HOST` запроса; «www» игнорируется.

#### <a name="PAY_YOU_TO_DO_IT"></a>Я не хочу возиться с установкой этого и заставить его работать с моим сайтом; Могу я просто заплатить вам за все это?

Может быть. Это рассматривается в каждом конкретном случае. Расскажите, что вам нужно, что Вы предлагаете, и мы расскажем вам, можем ли мы помочь.

#### <a name="HIRE_FOR_PRIVATE_WORK"></a>Могу ли я нанять вас или любого из разработчиков этого проекта для частной работы?

*См. Выше.*

#### <a name="SPECIALIST_MODIFICATIONS"></a>Мне нужны модификации специалиста, настройки и т.д.; Вы можете помочь?

*См. Выше.*

#### <a name="ACCEPT_OR_OFFER_WORK"></a>Я разработчик, веб-дизайнер, или программист. Могу ли я принять или предложить работу, связанную с этим проектом?

Да. Наша лицензия не запрещает это.

#### <a name="WANT_TO_CONTRIBUTE"></a>Я хочу внести свой вклад в проект; Я могу сделать это?

Да. Вклады в проект очень приветствуются. Для получения дополнительной информации см. «CONTRIBUTING.md».

#### <a name="CRON_TO_UPDATE_AUTOMATICALLY"></a>Могу ли я использовать cron для автоматического обновления?

Да. API встроен в фронтенд для взаимодействия со обновления страница через внешние скрипты. Имеется отдельный скрипт: «[Cronable](https://github.com/Maikuolan/Cronable)». Он может использоваться вашим cron manager или cron scheduler для автоматического обновления этого и других поддерживаемых пакетов (этот скрипт предоставляет собственную документацию).

#### <a name="WHAT_ARE_INFRACTIONS"></a>Что такое «нарушения»?

«Нарушения» определяют, когда IP-адрес, который еще не заблокирован никакими конкретными сигнатурными файлами, должен блокироваться для любых будущих запросов, и они тесно связаны с отслеживания IP. Существуют некоторые функциональные возможности и модули, которые позволяют блокировать запросы по причинам, отличным от IP-адреса источника (такие как наличие пользовательских агентов [user agents], соответствующих спам-ботам или инструментами взлома, опасные запросы, поддельный DNS и т.д.), и когда это произойдет, может произойти «нарушение». Они предоставляют возможность идентифицировать IP-адреса, которые соответствуют нежелательным запросам, которые еще не могут быть заблокированы с помощью каких-либо конкретных файлов сигнатур. Нарушения обычно соответствуют 1-к-1 с количеством блокировок IP, но не всегда (серьезные события блока могут иметь значение нарушения, превышающее одно, и если «track_mode» false, нарушения не будут происходить для событий блоков, инициированных исключительно сигнатурными файлами).

#### <a name="BLOCK_HOSTNAMES"></a>Может ли CIDRAM блокировать имена хостов?

Да. Этого можно добиться, создав вспомогательное правило или пользовательский модуль.

![Вспомогательное правило для блокировки имен хостов](https://raw.githubusercontent.com/CIDRAM/Docs/master/assets/auxrule_block_hostname.png)

#### <a name="WHAT_CAN_I_USE_FOR_DEFAULT_DNS"></a>Что я могу использовать для «default_dns»?

Как правило, IP-адрес любого надежного DNS-сервера должен быть достаточным. Если вы ищете предложения, [public-dns.info](https://public-dns.info/) и [OpenNIC](https://servers.opennic.org/) предоставляют обширные списки известных общедоступных DNS-серверов. В качестве альтернативы см. таблицу ниже:

IP | Оператор
---|---
`1.1.1.1` | [Cloudflare](https://www.cloudflare.com/learning/dns/what-is-1.1.1.1/)
`8.8.4.4`<br />`8.8.8.8`<br />`2001:4860:4860::8844`<br />`2001:4860:4860::8888` | [Google Public DNS](https://developers.google.com/speed/public-dns/)
`9.9.9.9`<br />`149.112.112.112` | [Quad9 DNS](https://www.quad9.net/)
`84.200.69.80`<br />`84.200.70.40`<br />`2001:1608:10:25::1c04:b12f`<br />`2001:1608:10:25::9249:d69b` | [DNS.WATCH](https://dns.watch/index)
`208.67.220.220`<br />`208.67.222.220`<br />`208.67.222.222` | [OpenDNS Home](https://www.opendns.com/)
`77.88.8.1`<br />`77.88.8.8`<br />`2a02:6b8::feed:0ff`<br />`2a02:6b8:0:1::feed:0ff` | [Yandex.DNS](https://dns.yandex.com/advanced/)
`8.20.247.20`<br />`8.26.56.26` | [Comodo Secure DNS](https://www.comodo.com/secure-dns/)
`216.146.35.35`<br />`216.146.36.36` | [Dyn](https://help.dyn.com/internet-guide-setup/)
`64.6.64.6`<br />`64.6.65.6` | [Verisign Public DNS](https://www.verisign.com/en_US/security-services/public-dns/index.xhtml)
`37.235.1.174`<br />`37.235.1.177`<br />`45.33.97.5`<br />`172.104.237.57`<br />`172.104.49.100` | [FreeDNS](https://freedns.zone/en/)
`156.154.70.1`<br />`156.154.71.1`<br />`2610:a1:1018::1`<br />`2610:a1:1019::1` | [Neustar Security](https://www.security.neustar/dns-services/free-recursive-dns-service)
`45.32.36.36`<br />`45.77.165.194` | [Fourth Estate](https://dns.fourthestate.co/)
`74.82.42.42` | [Hurricane Electric](https://dns.he.net/)
`195.46.39.39`<br />`195.46.39.40` | [SafeDNS](https://www.safedns.com/en/features/)
`89.233.43.71`<br />`91.239.100.100 `<br />`2001:67c:28a4::`<br />`2a01:3a0:53:53::` | [UncensoredDNS](https://blog.uncensoreddns.org/)
`208.76.50.50`<br />`208.76.51.51` | [SmartViper](https://www.markosweb.com/free-dns/)

*Заметка: Я не предъявляю никаких претензий или гарантий относительно практики конфиденциальности, безопасности, эффективности и надежности любых DNS-сервисов, перечисленных или иным образом. Пожалуйста, сделайте собственное исследование, когда принимаете решения о них.*

#### <a name="PROTECT_OTHER_THINGS"></a>Могу ли я использовать CIDRAM для защиты других вещей, помимо веб-сайтов (например, серверов электронной почты, FTP, SSH, IRC и т.д.)?

Вы можете (юридически), но не должны (технически; практически). Наша лицензия не ограничивает какие технологии используют CIDRAM, но CIDRAM является WAF (брандмауэром веб-приложений) и всегда предназначался для защиты веб-сайтов. Поскольку он не был разработан с учетом других технологий, он вряд ли будет эффективным или обеспечит надежную защиту других технологий, реализация, вероятно, будет сложной, и риск ложноположительный и пропущенных обнаружений очень высок.

#### <a name="CDN_CACHING_PROBLEMS"></a>Будут ли возникать проблемы, если я буду использовать CIDRAM одновременно с использованием CDN или кэширования?

Возможно. Это зависит от характера рассматриваемой услуги и того, как вы ее используете. Как правило, если вы только кэшируете статические активы (изображения, CSS, и т.д.; все, что обычно не меняется со временем), проблем не должно быть. Однако могут возникнуть проблемы, если вы кэшируете данные, которые в противном случае обычно генерировались бы динамически при запросе, или если вы кэшируете результаты запросов POST (это по существу сделает ваш сайт и его среду обязательным статическим, и CIDRAM вряд ли обеспечит какую-либо значимую выгоду в обязательной статической среде). Также могут быть особые требования к конфигурации для CIDRAM, в зависимости от того какой CDN или кэширующий сервис вы используете (вам необходимо убедиться, что CIDRAM настроен правильно для конкретной службы CDN или кэширования, которую вы используете). Неправильное конфигурирование CIDRAM может привести к значительно проблематичным ложным срабатываниям и пропущенным обнаружениям.

#### <a name="DDOS_ATTACKS"></a>Будет ли CIDRAM защищать мой сайт от атак DDoS?

Краткий ответ: Нет.

Чуть более длинный ответ: CIDRAM поможет уменьшить влияние нежелательного трафика на ваш сайт (таким образом снижая затраты на пропускную способность вашего веб-сайта), поможет уменьшить влияние нежелательного трафика на ваше оборудование (например, способность вашего сервера обрабатывать и обслуживать запросы), и может помочь уменьшить различные другие потенциальные негативные последствия, связанные с нежелательным трафиком. Однако для понимания этого вопроса необходимо помнить две важные вещи.

Во-первых, CIDRAM является пакетом PHP и, следовательно, работает на компьютере, где установлен PHP. Это означает, что CIDRAM может видеть и блокировать запрос только *после* того, как сервер уже получил его. Во-вторых, эффективное смягчение DDoS должно отфильтровывать запросы *до* того, как они достигнут сервера, на который нацелена атака DDoS. В идеале, атаки DDoS должны быть обнаружены и смягчены решениями, способными отбрасывать или перенаправлять трафик, связанный с атаками, прежде чем он достигнет целевого сервера в первую очередь.

Это может быть реализовано с использованием специализированных, локальных аппаратных решений, и/или облачные решения, такие как специализированные службы смягчения DDoS, маршрутизация DNS домена через сети, устойчивые к DDoS, облачная фильтрация, или их комбинацию. В любом случае, этот предмет слишком сложный, чтобы подробно объяснить всего лишь параграф или два, поэтому я бы рекомендовал продолжить исследования, если это предмет, который вы хотите продолжить. Когда истинный характер атак DDoS будет правильно понят, этот ответ будет иметь больше смысла.

#### <a name="CHANGE_COMPONENT_SORT_ORDER"></a>Когда я активирую или деактивирую модули или файлы сигнатуры на странице обновлений, он сортирует их по алфавиту в конфигурации. Могу ли я изменить способ сортировки?

Да. Если вам нужно заставить некоторые файлы выполнить в определенном порядке, вы можете добавить некоторые произвольные данные до их имен в директиве конфигурации, где они указаны, разделенные двоеточием. Когда страница обновлений впоследствии сортирует файлы снова, эти добавленные произвольные данные будут влиять на порядок сортировки, в результате чего они должны выполняться в том порядке, в котором вы хотите, без необходимости переименовывать их.

Например, предполагая конфигурационную директиву с файлами, перечисленными ниже:

`file1.php,file2.php,file3.php,file4.php,file5.php`

Если вы хотите, чтобы `file3.php` выполнялся первым, вы могли бы добавить что-то вроде `aaa:` перед именем файла:

`file1.php,file2.php,aaa:file3.php,file4.php,file5.php`

Затем, если новый файл, `file6.php`, активирован, когда страница обновлений снова сортирует их все, это должно закончиться следующим образом:

`aaa:file3.php,file1.php,file2.php,file4.php,file5.php,file6.php`

Такая же ситуация, когда файл деактивирован. Наоборот, если вы хотите, чтобы файл выполнялся последним, вы могли бы добавить что-то вроде `zzz:` перед именем файла. В любом случае вам не нужно будет переименовывать указанный файл.

#### <a name="HOW_TO_USE_PDO"></a>Что такое «PDO DSN»? Как я могу использовать PDO с CIDRAM?

«PDO» является акроним для «[PHP Data Objects](https://www.php.net/manual/ru/intro.pdo.php)» (объектов данных PHP). Он предоставляет интерфейс для PHP, чтобы иметь возможность подключаться к некоторым системам баз данных, обычно используемым различными приложениями PHP.

«DSN» является акроним для «[data source name](https://en.wikipedia.org/wiki/Data_source_name)» (имени источника данных). «PDO DSN» описывает как PDO должен подключаться к базе данных.

CIDRAM предоставляет возможность использовать PDO для целей кэширования. Чтобы это работало должным образом, вам необходимо соответствующим образом настроить CIDRAM, включив PDO, создать новую базу данных для CIDRAM использовать (если вы еще не имеете в виду базу данных для CIDRAM использовать), и создать новую Таблица в вашей базе данных в соответствии со структурой, описанной ниже.

Когда соединение с базой данных успешно, но необходимая таблица не существует, автоматическое создание таблицы будет предпринято. Тем не менее, это поведение не было тщательно проверено, и успех не может быть гарантирован.

Это, конечно, применимо, только если вы действительно хотите, чтобы CIDRAM использовал PDO. Если вы достаточно довольны тем, что CIDRAM использует кэширование плоских файлов (в соответствии с его конфигурацией по умолчанию) или любые другие предоставляемые опции кэширования, вам не нужно беспокоиться о настройке баз данных, таблиц, и т.д.

Структура, описанная ниже, использует «cidram» в имени базы данных, но вы можете использовать любое имя, которое вы хотите для своей базы данных, при условии, что это же имя реплицируется в конфигурации DSN.

```
╔══════════════════════════════════════════════╗
║ DATABASE "cidram"                            ║
║ │╔═══════════════════════════════════════════╩═════╗
║ └╫─TABLE "Cache" (UTF-8)                           ║
║  ╠═╪═FIELD══CHARSET═DATATYPE═════KEY══NULL═DEFAULT═╣
║  ║ ├─"Key"──UTF-8───VARCHAR(128)─PRI──×────×       ║
║  ║ ├─"Data"─UTF-8───TEXT─────────×────×────×       ║
╚══╣ └─"Time"─×───────INT(>=10)────×────×────×       ║
   ╚═════════════════════════════════════════════════╝
```

Директива конфигурации CIDRAM `pdo_dsn` должна быть настроена, как описано ниже.

```
Согласно базе данных драйвер используется...
├─4d (Предупреждение: экспериментально, не проверено, не рекомендуется!)
│ │
│ │         ╔═══════╗
│ └─4D:host=localhost;charset=UTF-8
│           ╚╤══════╝
│            └Хост, с которым нужно связаться, чтобы найти базу данных.
├─cubrid
│ │
│ │             ╔═══════╗      ╔═══╗        ╔═════╗
│ └─cubrid:host=localhost;port=33000;dbname=example
│               ╚╤══════╝      ╚╤══╝        ╚╤════╝
│                │              │            └Имя базы данных для
│                │              │             использования.
│                │              │
│                │              └Номер порта для подключения к хосту.
│                │
│                └Хост, с которым нужно связаться, чтобы найти базу данных.
├─dblib
│ │
│ │ ╔═══╗      ╔═══════╗        ╔═════╗
│ └─dblib:host=localhost;dbname=example
│   ╚╤══╝      ╚╤══════╝        ╚╤════╝
│    │          │                └Имя базы данных для использования.
│    │          │
│    │          └Хост, с которым нужно связаться, чтобы найти базу данных.
│    │
│    └Возможные значения: «mssql», «sybase», «dblib».
├─firebird
│ │
│ │                 ╔═══════════════════╗
│ └─firebird:dbname=/path/to/database.fdb
│                   ╚╤══════════════════╝
│                    ├Может быть путем к файлу локальной базы данных.
│                    │
│                    ├Может соединиться с хостом и номером порта.
│                    │
│                    └Вам следует обратиться к документации Firebird, если вы
│                     хотите использовать это.
├─ibm
│ │
│ │         ╔═════╗
│ └─ibm:DSN=example
│           ╚╤════╝
│            └Каталогизированная база данных для связи.
├─informix
│ │
│ │              ╔═════╗
│ └─informix:DSN=example
│                ╚╤════╝
│                 └Каталогизированная база данных для связи.
├─mysql (Наиболее рекомендуется!)
│ │
│ │              ╔═════╗      ╔═══════╗      ╔══╗
│ └─mysql:dbname=example;host=localhost;port=3306
│                ╚╤════╝      ╚╤══════╝      ╚╤═╝
│                 │            │              └Номер порта для подключения к
│                 │            │               хосту.
│                 │            │
│                 │            └Хост, с которым нужно связаться, чтобы найти
│                 │             базу данных.
│                 │
│                 └Имя базы данных для использования.
├─oci
│ │
│ │            ╔═════╗
│ └─oci:dbname=example
│              ╚╤════╝
│               ├Может ссылаться на конкретную каталогизированную базу данных.
│               │
│               ├Может соединиться с хостом и номером порта.
│               │
│               └Вам следует обратиться к документации Oracle, если вы хотите
│                использовать это.
├─odbc
│ │
│ │      ╔═════╗
│ └─odbc:example
│        ╚╤════╝
│         ├Может ссылаться на конкретную каталогизированную базу данных.
│         │
│         ├Может соединиться с хостом и номером порта.
│         │
│         └Вам следует обратиться к документации ODBC/DB2, если вы хотите
│          использовать это.
├─pgsql
│ │
│ │            ╔═══════╗      ╔══╗        ╔═════╗
│ └─pgsql:host=localhost;port=5432;dbname=example
│              ╚╤══════╝      ╚╤═╝        ╚╤════╝
│               │              │           └Имя базы данных для использования.
│               │              │
│               │              └Номер порта для подключения к хосту.
│               │
│               └Хост, с которым нужно связаться, чтобы найти базу данных.
├─sqlite
│ │
│ │        ╔════════╗
│ └─sqlite:example.db
│          ╚╤═══════╝
│           └Путь к файлу локальной базы данных для использования.
└─sqlsrv
  │
  │               ╔═══════╗ ╔══╗          ╔═════╗
  └─sqlsrv:Server=localhost,1521;Database=example
                  ╚╤══════╝ ╚╤═╝          ╚╤════╝
                   │         │             └Имя базы данных для использования.
                   │         │
                   │         └Номер порта для подключения к хосту.
                   │
                   └Хост, с которым нужно связаться, чтобы найти базу данных.
```

Если Вы не уверены, что использовать для какой-либо конкретной части вашего DSN, попробуйте сначала выяснить, работает ли она как есть, ничего не меняя.

Обратите внимание, что `pdo_username` и `pdo_password` должны совпадать с именем пользователя и паролем, которые Вы выбрали для своей базы данных.

#### <a name="BLOCK_CRON"></a>CIDRAM блокирует cronjobs; Как это исправить?

Если Вы используете выделенный файл для целей cronjobs и если этот файл не нужно вызывать во время обычных пользовательских запросов (т.е., вне контекста cronjobs), убедиться, что CIDRAM вообще не выполняется во время ваших cronjobs (т.е., не подключайте CIDRAM к файлу, ответственному за обработку ваших cronjobs) – Это самый простой способ исправить это.

В качестве альтернативы, если это невозможно, но IP-адрес вашего сервера cron является относительно последовательным и предсказуемым, Вы можете попробовать занести в белый список IP-адрес вашего сервера cron, например, путем создания сигнатуры в индивидуальный файле сигнатуры, или путем создания вспомогательного правила. Если IP-адрес вашего сервера cron регулярно вращается и не особенно предсказуемо, но тем не менее остается внутри той же конкретной сети, Вы можете попробовать указать в своем файле `ignore.dat` имя раздела сигнатуры, ответственного за его блокировку.

Если Вы попробовали все эти идеи и ни одна из них не сработала для вас, или если вам нужна помощь, чтобы выяснить, как это сделать, Вы можете создать новую issue на странице issues CIDRAM, чтобы попросить о помощи.

---


### 11. <a name="SECTION11"></a>ЛЕГАЛЬНАЯ ИНФОРМАЦИЯ

#### 11.0 ПРЕАМБУЛА РАЗДЕЛА

Этот раздел документации предназначен для описания возможных юридических соображений, касающихся использования и имплементации пакета, и предоставления некоторой базовой связанной информации. Это может быть важно для некоторых пользователей в качестве средства обеспечения соответствия любым юридическим требованиям, которые могут существовать в странах, в которых они работают, и некоторым пользователям, возможно, придется корректировать свои политики веб-сайта в соответствии с этой информацией.

Прежде всего, поймите, что я (автор пакета) не квалифицированный юрист любого рода. Поэтому я не имею юридической силы для предоставления юридических консультаций. Кроме того, в некоторых случаях, точные законодательные требования могут различаться между различными странами и юрисдикциями, и эти различные юридические требования могут иногда противоречить (таких как, например, в случае стран, которые поддерживают права на [неприкосновенность частной жизни](https://ru.wikipedia.org/wiki/%D0%9D%D0%B5%D0%BF%D1%80%D0%B8%D0%BA%D0%BE%D1%81%D0%BD%D0%BE%D0%B2%D0%B5%D0%BD%D0%BD%D0%BE%D1%81%D1%82%D1%8C_%D1%87%D0%B0%D1%81%D1%82%D0%BD%D0%BE%D0%B9_%D0%B6%D0%B8%D0%B7%D0%BD%D0%B8), и [право быть забытым](https://ru.wikipedia.org/wiki/%D0%9F%D1%80%D0%B0%D0%B2%D0%BE_%D0%BD%D0%B0_%D0%B7%D0%B0%D0%B1%D0%B2%D0%B5%D0%BD%D0%B8%D0%B5), по сравнению с странами, которые предпочитают [расширенное хранение данных](https://ru.wikipedia.org/wiki/%D0%97%D0%B0%D0%BA%D0%BE%D0%BD_%D0%AF%D1%80%D0%BE%D0%B2%D0%BE%D0%B9)). Учтите также, что доступ к пакету не ограничивается конкретными странами или юрисдикциями, и, следовательно, пользовательская база пакетов, вероятно, будет географически разнообразной. При рассмотрении этих вопросов, я не в состоянии заявить, что это означает быть «юридически совместимым» для всех пользователей, во всех отношениях. Однако я надеюсь, что приведенная здесь информация поможет вам самим принять решение о том, что вы должны сделать, чтобы оставаться юридически совместимым в контексте пакета. Если у вас есть какие-либо сомнения относительно информации, или если вам нужна дополнительная помощь и рекомендации с юридической точки зрения, Я бы рекомендовал обратиться к квалифицированному юристу.

#### 11.1 ОТВЕТСТВЕННОСТЬ

В соответствии с уже заявленной лицензией на пакет, пакет предоставляется без каких-либо гарантий. Это включает (но не ограничивается) всю сферу ответственности. Пакет предоставляется вам для вашего удобства, в надежде, что он будет полезен, и что он принесет вам определенную пользу. Однако, независимо от того, используете ли вы или реализуете пакет, это ваш собственный выбор. Вы не обязаны использовать или внедрять пакет, но когда вы это делаете, вы несете ответственность за это решение. Ни я, ни другие участники пакета не несут юридическую ответственность за последствия решений, которые вы принимаете, независимо от того, являются ли они прямыми, косвенными, подразумеваемыми или нет.

#### 11.2 ТРЕТЬИ ЛИЦА

В зависимости от его точной конфигурации и имплементации пакет может передавать и обмениваться информацией с третьими лицами в некоторых случаях. Эта информация может быть определена как «[персональные данные](https://ru.wikipedia.org/wiki/%D0%9F%D0%B5%D1%80%D1%81%D0%BE%D0%BD%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D0%B5_%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D0%B5)» (PII/ПИИ) в некоторых контекстах, в некоторых юрисдикциях.

Как эта информация может использоваться этими третьими лицами, зависит от различных политик, установленных этими третьими лицами, и выходит за рамки этой документации. Однако, во всех таких случаях обмен информацией с этими третьими лицами может быть отключен. Во всех таких случаях, если вы решите включить его, вы несете ответственность за исследование любых проблем, которые могут возникнуть в отношении конфиденциальности, безопасности и использования PII/ПИИ этими третьими лицами. Если существуют какие-либо сомнения, или если вы неудовлетворены действиями этих третьих сторон в отношении PII/ПИИ, лучше всего отключить весь обмен информацией с этими третьими лицами.

В целях прозрачности тип информации, совместно используемой, и с кем, описан ниже.

##### 11.2.0 ПОИСК ИМЯ ХОСТА

Если вы используете какие-либо функции или модули, предназначенные для работы с именами хостов (например, "модуль блокатор для плохие хосты", "tor project exit nodes block module", или "проверка поисковой системы"), CIDRAM должен иметь возможность получить имя хоста входящих запросов. Как правило, он делает это, запрашивая имя хоста IP-адреса входящих запросов с DNS-сервера, или путем запроса информации через функциональные возможности, предоставляемые системой, где установлен CIDRAM (это обычно называют «поиском имени хоста»). DNS-серверы, определенные по умолчанию, принадлежат службе [Google DNS](https://dns.google.com/) (но это можно легко изменить с помощью конфигурации). Точные услуги, которые связаны с, зависят от конфигурации (это можно легко отрегулировать). В случае использования функциональных возможностей, предоставляемых системой, где установлен CIDRAM, вам необходимо обратиться к системному администратору, чтобы определить, какие поисковые запросы маршрутов используются. Поиск имени хоста можно предотвратить в CIDRAM, избегая затронутых модулей, или изменяя конфигурацию пакета в соответствии с вашими потребностями.

*Соответствующие директивы конфигурации:*
- `general` -> `default_dns`
- `general` -> `search_engine_verification`
- `general` -> `social_media_verification`
- `general` -> `other_verification`
- `general` -> `force_hostname_lookup`
- `general` -> `allow_gethostbyaddr_lookup`

##### 11.2.1 ВЕБ ФОНТЫ

Некоторые пользовательские темы, а также стандартный «UI» (пользовательский интерфейс) для фронтенд CIDRAM и страница «Доступ Закрыт» могут использовать веб фонты по эстетическим соображениям. Веб фонты отключен по умолчанию, но когда он включен, происходит прямая связь между браузером пользователя и сервисом, на котором размещаются веб-сайты. Это может потенциально включать в себя передачу информации, такой как IP-адрес пользователя, пользовательский агент, операционная система и другие данные, доступные для запроса. Большинство этих веб фонтов размещены службой [Google Fonts](https://fonts.google.com/).

*Соответствующие директивы конфигурации:*
- `general` -> `disable_webfonts`

##### 11.2.2 ПРОВЕРКА ПОИСКОВЫХ СИСТЕМ И СОЦИАЛЬНЫХ СЕТЕЙ

Когда проверка поисковых систем включена, CIDRAM пытается выполнить «переадресацию DNS-запросов», чтобы проверить, являются ли запросы, утверждающие, что они происходят из поисковых систем, являются подлинными. По аналогии, когда включена проверка социальных сетей, CIDRAM делает то же самое для кажущихся запросов социальных сетях. Для этого он использует службу [Google DNS](https://dns.google.com/) для попытки разрешить IP-адреса из имен хостов этих входящих запросов (в этом процессе имена хостов этих запросов совместно используются службой).

*Соответствующие директивы конфигурации:*
- `general` -> `search_engine_verification`
- `general` -> `social_media_verification`
- `general` -> `other_verification`

##### 11.2.3 CAPTCHA

CIDRAM поддерживает reCAPTCHA и hCAPTCHA. Для правильной работы им требуются ключи API. Стандартно они отключены, но их можно включить, настроив необходимые ключи API. При включении может происходить обмен данными между службой и CIDRAM или браузером пользователя. Это может потенциально включать передачу информации, такой как IP-адрес пользователя, пользовательский агент, операционная система, и другие детали, доступные для запроса.

##### 11.2.4 STOP FORUM SPAM

[Stop Forum Spam](https://www.stopforumspam.com/) – Это фантастический бесплатный сервис, который может помочь защитить форумы, блоги и веб-сайты от спамеров. Он делает это, предоставляя базу данных известных спамеров и API, который может быть использован для проверки того, указан ли IP-адрес, имя пользователя или адрес электронной почты в его базе данных.

CIDRAM предоставляет необязательный модуль, который использует этот API для проверки того, принадлежит ли IP-адрес входящих запросов к подозреваемому спамеру. Модуль не установлен по умолчанию, но если вы решите его установить, пользовательские IP-адреса могут использоваться совместно с API-интерфейсом Stop Forum Spam в соответствии с назначенной целью модуля. Когда модуль установлен, CIDRAM связывается с этим API всякий раз, когда входящий запрос запрашивает ресурс, который CIDRAM распознает как тип ресурса, часто предназначенный для спамеров (например, страницы входа, страницы регистрации, страницы проверки электронной почты, формы комментариев и т.д.).

##### 11.2.5 ABUSEIPDB

CIDRAM предоставляет необязательный модуль для блокировки оскорбительный IP-адресов с помощью API [AbuseIPDB](https://www.abuseipdb.com/). Модуль не установлен по умолчанию, но если вы решите его установить, пользовательские IP-адреса могут использоваться совместно с API-интерфейсом AbuseIPDB в соответствии с назначенной целью модуля.

##### 11.2.6 BGPVIEW, IP-API

CIDRAM предоставляет дополнительные модули для выполнения поиска ASN и кода страны с помощью [BGPView](https://bgpview.io/) API и [IP-API](https://ip-api.com/) API. Эти поиски предоставляют возможность блокировать или вносить в белый список запросы на основе их ASN или страны происхождения. Модули не установлены по умолчанию, но если один из них установлен, пользовательские IP-адреса могут использоваться совместно с сервисом в соответствии с назначенной целью модуля.

#### 11.3 ЖУРНАЛОВ

Журналов (альтернативно: регистрация, логгинг) – Это важная часть CIDRAM по ряду причин. Может быть трудно диагностировать и разрешать ложные-срабатывания, когда события блока, вызывающие их, не регистрируются. Без регистрируются событий блока может быть трудно точно определить, насколько эффективная CIDRAM в любом конкретном контексте, и может быть трудно определить, где его недостатки могут быть, и какие изменения могут потребоваться для его конфигурации или сигнатуры соответственно, чтобы он продолжал функционировать по назначению. Несмотря на это, регистрация может быть нежелательна для всех пользователей и остается полностью необязательной. В CIDRAM регистрация по умолчанию отключена. Чтобы включить его, CIDRAM должен быть настроен соответствующим образом.

Дополнительно, ли ведение журнала разрешено законом, и в какой степени (например, типы информации, которые могут быть зарегистрированы, как долго, и при каких обстоятельствах), может варьироваться в зависимости от юрисдикции и контекста, в котором реализуется CIDRAM (например, если вы работаете как индивидуальный лицо, корпоративный лицо, если вы работаете на коммерческой или некоммерческой основе). Поэтому это может быть полезно для вас внимательно прочитать этот раздел.

CIDRAM может выполнять несколько типов ведения журнала. Различные типы ведения журнала включают различные типы информации по разным причинам.

##### 11.3.0 БЛОКИРОВАТЬ СОБЫТИЯ

Основной тип ведения журнала, который может выполнять CIDRAM, относится к «блочным событиям». Этот тип ведения журнала относится к тому, когда CIDRAM блокирует запрос, и может предоставляться в трех разных форматах:
- Человекочитаемые лог-файлы.
- Лог-файлы в стиле Apache.
- Сериализованные лог-файлы.

Событие блока, записанное в человекочитаемые лог-файлы, обычно выглядит примерно так (в качестве примера):

```
ИД: 1234
Скрипт Версия: CIDRAM v1.6.0
Дата/Время: Day, dd Mon 20xx hh:ii:ss +0000
IP-адрес: x.x.x.x
Имя хоста: dns.hostname.tld
Количество сигнатурей: 1
Идентификаторы для сигнатурей: x.x.x.x/xx
Почему Заблокированные: Облачный сервис ("Имя Сети", Lxx:Fx, [XX])!
Агент пользователя (User Agent): Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3359.181 Safari/537.36
Реконструированный URI: https://your-site.tld/index.php
Статус CAPTCHA: Включается.
```

Это же событие блока, записанное в лог-файл в стиле Apache, будет выглядеть примерно так:

```
x.x.x.x - - [Day, dd Mon 20xx hh:ii:ss +0000] "GET /index.php HTTP/1.1" 200 xxxx "-" "Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3359.181 Safari/537.36"
```

Зарегистрированное событие блокировки обычно включает следующую информацию:
- Идентификационный номер, ссылающийся на событие блока.
- Версия используемой CIDRAM.
- Дата и время, когда произошло событие блока.
- IP-адрес заблокированного запроса.
- Имя хоста IP-адреса заблокированного запроса (если доступно).
- Количество сигнатурей, вызванных запросом.
- Ссылки на сигнатуры срабатывают.
- Ссылки на причины блочного события и некоторые основные связанные данные об отладке.
- Пользовательский агент заблокированного запроса (как запрашивающий объект идентифицировал себя с запросом).
- Реконструкция идентификатора запрашиваемого ресурса.
- Состояние CAPTCHA для текущего запроса (при необходимости).

*Директивы конфигурации, отвечающие за этот тип ведения журнала, и для каждого из трех доступных форматов:*
- `general` -> `logfile`
- `general` -> `logfile_apache`
- `general` -> `logfile_serialized`

Когда эти директивы остаются пустыми, этот тип ведения журнала останется отключенным.

##### 11.3.1 CAPTCHA ЖУРНАЛОВ

Этот тип ведения журнала относится конкретно к экземплярам CAPTCHA и возникает только тогда, когда пользователь пытается завершить экземпляр CAPTCHA.

Запись журнала CAPTCHA содержит IP-адрес пользователя, пытающегося выполнить экземпляр CAPTCHA, дату и время, в которое произошла попытка, и состояние CAPTCHA. Запись журнала CAPTCHA обычно выглядит примерно так (в качестве примера):

```
IP-адрес: x.x.x.x - Дата/Время: Day, dd Mon 20xx hh:ii:ss +0000 - Статус CAPTCHA: Успех!
```

*Директива конфигурации, ответственная за ведение журнала CAPTCHA:*
- `recaptcha` -> `logfile`
- `hcaptcha` -> `logfile`

##### 11.3.2 ФРОНТЕНД ЖУРНАЛОВ

Этот тип ведения журнала связан с попытками входа в фронтенд и возникает только тогда, когда пользователь пытается войти в фронтенд (при условии, что фронтенд включен).

Эти записи журнала содержат IP-адрес пользователя, пытающегося войти в систему, дату и время совершения попытки, и результаты попытки (успешно вошел в систему или не смог войти в систему). Обычно они выглядят примерно так (в качестве примера):

```
x.x.x.x - Day, dd Mon 20xx hh:ii:ss +0000 - "admin" - Вошли в систему.
```

*Соответствующие директивы конфигурации:*
- `general` -> `frontend_log`

##### 11.3.3 ВРАЩЕНИЕ ЖУРНАЛА

Возможно, вы захотите очистить журналы через определенный промежуток времени или, возможно, потребуется сделать это по закону (то есть, количество времени, которое законно допустимо для вас сохранять журналы, может быть ограничено законом). Вы можете достичь этого, включив маркеры даты/времени в имена ваших файлов журналов в соответствии с настройками вашего пакета (например, `{yyyy}-{mm}-{dd}.log`), и затем разрешить вращение журнала (поворот журнала позволяет выполнять некоторые действия на лог-файлах при превышении указанных пределов).

Например: Если мне было необходимо закончить журналы через 30 дней, я мог бы указать `{dd}.log` в именах моих лог-файлов (`{dd}` представляет дни), установить значение `log_rotation_limit` в 30, и установить значение `log_rotation_action` в `Delete`.

И наоборот, если вам необходимо сохранять журналы в течение длительного периода времени, вы можете либо не использовать поворот журнала вообще, либо вы можете установить значение `log_rotation_action` в `Archive`, чтобы сжать лог-файлы, тем самым уменьшив общий объем занимаемого ими дискового пространства.

*Соответствующие директивы конфигурации:*
- `general` -> `log_rotation_limit`
- `general` -> `log_rotation_action`

##### 11.3.4 УСЕЧЕНИЕ ЖУРНАЛА

Также возможно обрезать отдельные лог-файлы, если они превышают определенный размер, если это то, что вы хотите/нуждаетесь сделать.

*Соответствующие директивы конфигурации:*
- `general` -> `truncate`

##### 11.3.5 ПСЕВДОНИМИЗАЦИЯ IP-АДРЕСА

Во-первых, если вы не знакомы с термином, «псевдонимизация» относится к обработке персональных данных таким образом, что она не может быть идентифицирована ни с каким конкретным объектом данных без дополнительной информации, и при условии, что такая дополнительная информация поддерживается отдельно и подлежит техническим и организационным мерам для обеспечения того, чтобы личные данные не могли быть идентифицированы ни одному физическому лицу.

В некоторых случаях вам может быть юридически требуется анонимизировать или псевдонимизировать любого PII/ПИИ, собранного, обработанного, или сохраненного. Хотя эта концепция существует уже довольно давно, GDPR/DSGVO особенно упоминает и специально поощряет «псевдонимизация».

CIDRAM может псевдонимизировать IP-адреса при входе в журналы, если это то, что вы хотите/нуждаетесь сделать. Когда CIDRAM псевдонимизирует IP-адреса, при входе в журналы, окончательный октет адресов IPv4, и все после второй части адресов IPv6 представлено символом «x» (эффективно округляя адреса IPv4 до начального адреса 24-й подсети, в которую они входят, и адреса IPv6 на начальный адрес 32-й подсети, в которую они входят).

*Заметка: Процесс псевдонимизации IP-адреса в CIDRAM не влияет на функцию отслеживания IP-адресов в CIDRAM. Если это проблема для вас, лучше всего отключить IP-отслеживание. Этого можно добиться, установив `track_mode` на `false` и избегая любых модулей.*

*Соответствующие директивы конфигурации:*
- `signatures` -> `track_mode`
- `legal` -> `pseudonymise_ip_addresses`

##### 11.3.6 ОПУСКАЯ ИНФОРМАЦИЮ ЖУРНАЛА

Если вы хотите сделать еще один шаг, не позволяя полностью регистрировать определенные типы информации, это также можно сделать. CIDRAM предоставляет директивы конфигурации для контроля того, включены ли IP-адреса, имена хостов, и пользовательские агенты в журналы. По умолчанию все три эти точки данных включены в журналы, когда они доступны. Установка любой из этих директив конфигурации на `true` будет пропускать соответствующую информацию из журналов.

*Заметка: Нет никаких оснований для псевдонимизировать IP-адресов при полном исключении их из журналов.*

*Соответствующие директивы конфигурации:*
- `legal` -> `omit_ip`
- `legal` -> `omit_hostname`
- `legal` -> `omit_ua`

##### 11.3.7 СТАТИСТИКА

CIDRAM необязательно может отслеживать статистику, такую как общее количество событий блока или экземпляров CAPTCHA, которые произошли с определенного момента времени. Эта функция отключена по умолчанию, но можно включить с помощью конфигурации пакета. Эта функция отслеживает только общее количество произошедших событий и не содержит никакой информации о конкретных событиях (и поэтому не следует рассматривать как PII/ПИИ).

*Соответствующие директивы конфигурации:*
- `general` -> `statistics`

##### 11.3.8 ШИФРОВАНИЕ

CIDRAM не шифрует свой кэш или какую-либо информацию журнала. [Шифрование](https://ru.wikipedia.org/wiki/%D0%A8%D0%B8%D1%84%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5) кэша и журналов могут быть введены в будущем, но в настоящее время нет конкретных планов. Если вы обеспокоены тем, что несанкционированные сторонние лица получают доступ к частям CIDRAM, которые могут содержать PII/ПИИ или конфиденциальную информацию, такую как ее кэш или журналы, я бы рекомендовал, чтобы CIDRAM не был установлен в общедоступном месте (например, установить CIDRAM за пределами стандартного каталога `public_html` или его эквивалента, доступного большинству стандартных веб-серверов) и я рекомендую применять соответствующие ограничительные разрешения для каталога установки (в частности, для каталога «vault»). Если этого недостаточно для решения ваших проблем, настройте CIDRAM таким образом, чтобы типы информации, вызывающие ваши проблемы, не собирались или не регистрировались в первую очередь (например, путем отключения ведения журнала).

#### 11.4 КУКИ

CIDRAM устанавливает файлы [куки](https://ru.wikipedia.org/wiki/Cookie) в двух точках своей кодовой базы. Во-первых, когда пользователь успешно завершает экземпляр CAPTCHA (and assuming that `lockuser` is set to `true`), CIDRAM устанавливает куки, чтобы иметь возможность запоминать для последующих запросов, что пользователь уже завершил экземпляр CAPTCHA, так что ему не нужно постоянно запрашивать у пользователя завершение экземпляра CAPTCHA при последующих запросах. Во-вторых, когда пользователь успешно входит в фронтенд, CIDRAM устанавливает куки, чтобы иметь возможность запоминать пользователя для последующих запросов (то есть, куки используются для аутентификации пользователя в сеансе фронтенд).

В обоих случаях предупреждения куки отображаются на видном месте (если применимо), предупреждающее пользователя о том, что куки будет установлен, если они участвуют в соответствующем действии. Куки не установлены ни в одном другом месте в кодовой базе.

*Заметка: «Невидимые» CAPTCHA API могут быть несовместимы с законами о файлах куки в некоторых юрисдикциях, и следует избегать на любых сайтах, на которые распространяются такие законы. Может быть предпочтительнее использовать вместо этого другие предоставленные API, или просто полностью отключить CAPTCHA.*

*Соответствующие директивы конфигурации:*
- `general` -> `disable_frontend`
- `recaptcha` -> `lockuser`
- `recaptcha` -> `api`
- `hcaptcha` -> `lockuser`
- `hcaptcha` -> `api`

#### 11.5 МАРКЕТИНГ И РЕКЛАМА

CIDRAM не собирает и не обрабатывает какую-либо информацию для маркетинговых или рекламных целей и не продает и не получает прибыль от любой собранной или занесенной в журнал информации. CIDRAM не коммерческим предприятием и не имеет отношения к каким-либо коммерческим интересам, поэтому делать это не имеет смысла. Это имело место с самого начала проекта и по-прежнему имеет место сегодня. Кроме того, делать эти вещи было бы контрпродуктивным для духа и намеченной цели проекта в целом, и до тех пор, пока я продолжаю поддерживать проект, никогда не произойдет.

#### 11.6 ПОЛИТИКА КОНФИДЕНЦИАЛЬНОСТИ

В некоторых случаях вам может быть юридически необходимо четко отображать ссылку на вашу политику конфиденциальности на всех страницах и разделах вашего сайта. Это может быть важно как средство обеспечения того, чтобы пользователи были хорошо информированы о ваших точных правилах конфиденциальности, типах PII/ПИИ, которые вы собираете, и о том, как вы собираетесь их использовать. Чтобы иметь возможность включить такую ссылку на странице CIDRAM «Доступ Закрыт», предоставляется директива конфигурации для указания URL-адреса вашей политики конфиденциальности.

*Заметка: Настоятельно рекомендуется, чтобы страница политики конфиденциальности не была помещена за защитой CIDRAM. Если CIDRAM защищает вашу страницу политики конфиденциальности, а пользователь, заблокированный CIDRAM, нажимает ссылку на вашу политику конфиденциальности, они будут снова заблокированы и не смогут увидеть вашу политику конфиденциальности. В идеале вы должны ссылаться на статическую копию вашей политики конфиденциальности, такую как HTML-страница или текстовый файл, который не защищен CIDRAM.*

*Соответствующие директивы конфигурации:*
- `legal` -> `privacy_policy`

#### 11.7 GDPR/DSGVO

«Общее Регулирование Защиты Данных» – Это регламент Европейского Союза, который вступает в силу с 25 Мая 2018 года. Основная цель регулирования – Дать контроль гражданам и жителям ЕС в отношении их личных данных, и унифицировать регулирование в ЕС относительно конфиденциальности и личных данных.

Регулирование содержит конкретные положения, касающиеся обработки «[личной идентифицируемой информации](https://ru.wikipedia.org/wiki/%D0%9F%D0%B5%D1%80%D1%81%D0%BE%D0%BD%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D0%B5_%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D0%B5)» (PII/ПИИ) любых «субъектов данных», (любое идентифицированное или идентифицируемое физическое лицо) из или в пределах ЕС. Чтобы соответствовать регулированию, «предприятия» (согласно определению, указанным в регулирование), и любые соответствующие системы и процессы должны реализовать «конфиденциальность по дизайну» по умолчанию, должны использовать максимально возможные настройки конфиденциальности, должны обеспечивать необходимые гарантии для любой сохраненной или обработанной информации (включая, но не ограничиваясь, внедрение псевдонимизированный или полную анонимизированный данных), должны четко и недвусмысленно объявлять типы собираемых ими данных, как они обрабатывают его, по каким причинам, как долго они его сохраняют, и делится ли они этими данными с любыми третьими лицами, типами данных, совместно используемыми с третьими лицами, как, почему, и т.д.

Данные не могут быть обработаны, если нет законных оснований для этого, в соответствии с определением правила. Как правило, это означает, что для обработки данных субъекта данных на законной основе, это должно выполняться в соответствии с юридическими обязательствами, или только после того, как явное, хорошо информированное, однозначное согласие было получено от субъекта данных.

Поскольку аспекты регулирования могут развиваться во времени, чтобы избежать распространения устаревшей информации, лучше узнать о регулировании из авторитетного источника, а не просто включать соответствующую информацию в документацию к пакету (которые в конечном итоге могут устареть, поскольку регулирование развивается).

Некоторые рекомендуемые ресурсы для получения дополнительной информации:
- [Новый европейский регламент по защите данных – последствия для российских организаций](https://www.buzko.legal/content-ru/general-data-protection-regulation)
- [GDPR — новые правила обработки персональных данных в Европе для международного IT-рынка](https://habr.com/company/digitalrightscenter/blog/344064/)
- [Общий регламент по защите данных](https://ru.wikipedia.org/wiki/%D0%9E%D0%B1%D1%89%D0%B8%D0%B9_%D1%80%D0%B5%D0%B3%D0%BB%D0%B0%D0%BC%D0%B5%D0%BD%D1%82_%D0%BF%D0%BE_%D0%B7%D0%B0%D1%89%D0%B8%D1%82%D0%B5_%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85)
- [REGULATION (EU) 2016/679 OF THE EUROPEAN PARLIAMENT AND OF THE COUNCIL](https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=celex:32016R0679)

---


Последнее обновление: 28 Января 2024 г (2024.01.28).
